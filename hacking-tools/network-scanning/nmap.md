# ЁЯМР Nmap - Network Mapper (Advanced Guide)

> `nmap` р╕Др╕╖р╕нр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╣Бр╕Бр╕Щр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╕бр╕▓р╕Бр╕Чр╕╡р╣Ир╕кр╕╕р╕Фр╣Гр╕Щр╣Вр╕ер╕Б Cyber Security  
> р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х, fingerprint OS/Service, р╕Хр╕гр╕зр╕Ир╕лр╕▓ CVE р╣Бр╕ер╕░р╕лр╕ер╕нр╕Бр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Др╕Фр╣Йр╕Фр╣Йр╕зр╕в

---

## ЁЯз░ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З

```bash
sudo apt update
sudo apt install nmap
```

---

## тЪЩя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы

```bash
nmap [TARGET] [OPTIONS]
```

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
nmap -sS -p- -sV -O -T4 -Pn <IP>
```

---

## ЁЯУж р╕лр╕бр╕зр╕Ф Option р╕кр╕│р╕Др╕▒р╕Н

### ЁЯзк р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ (Scan Type)

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-sS` | SYN Scan (Stealth) тЬЕ р╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕вр╕Чр╕╡р╣Ир╕кр╕╕р╕Ф |
| `-sT` | TCP Connect (р╣Др╕бр╣И stealth, р╣Гр╕Кр╣Йр╣Ар╕бр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕Кр╣Й root) |
| `-sU` | UDP Scan |
| `-sN` | Null Scan (р╣Др╕бр╣Ир╕бр╕╡ flag р╣Гр╕Ф р╣Ж) |
| `-sF` | FIN Scan |
| `-sX` | Xmas Scan |

---

### ЁЯМР Target & Port

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-p-` | р╕кр╣Бр╕Бр╕Щр╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Х (1тАУ65535) |
| `-p 22,80,443` | р╕кр╣Бр╕Бр╕Щр╣Ар╕Йр╕Юр╕▓р╕░р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕ |
| `-F` | р╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕вр╕нр╕Фр╕Щр╕┤р╕вр╕б (100 р╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕гр╕Б) |

---

### ЁЯФН Service Detection

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-sV` | р╕Хр╕гр╕зр╕И version р╕Вр╕нр╕З service |
| `--version-intensity <0-9>` | р╕Др╕зр╕▓р╕бр╕ер╕╢р╕Бр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕И version (default: 7) |

---

### ЁЯза OS Detection

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-O` | р╕Хр╕гр╕зр╕Ир╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕г (OS Fingerprinting) |
| `--osscan-guess` | р╣Ар╕Фр╕▓ OS р╣Бр╕бр╣Йр╣Др╕бр╣Ир╣Бр╕бр╣Ир╕Щр╕вр╕│ |

---

### ЁЯЪА Speed & Timing (`-T`)

| Level | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|-------|-----------|
| `-T0` | Paranoid тЖТ р╕Кр╣Йр╕▓р╕Чр╕╡р╣Ир╕кр╕╕р╕Ф (р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З IDS) |
| `-T1` | Sneaky тЖТ р╕Кр╣Йр╕▓р╕бр╕▓р╕Б |
| `-T2` | Polite тЖТ р╕Кр╣Йр╕▓р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З |
| `-T3` | Normal (default) |
| `-T4` | Aggressive тЖТ р╣Ар╕гр╣Зр╕з, р╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕в |
| `-T5` | Insane тЖТ р╣Ар╕гр╣Зр╕зр╕бр╕▓р╕Б, р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Цр╕╣р╕Б detect |

> тЬЕ р╣Гр╕Кр╣Й `-T4` р╣Ар╕Ыр╣Зр╕Щ default р╕лр╕▓р╕Бр╣Др╕бр╣Ир╕Бр╕ер╕▒р╕зр╕Цр╕╣р╕Б IDS р╕Ир╕▒р╕Ъ

---

### ЁЯХ╡я╕ПтАНтЩВя╕П Spoofing & Evasion

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-D RND:10` | р╕кр╕гр╣Йр╕▓р╕З IP р╕Ыр╕ер╕нр╕б (decoy) 10 IP |
| `--spoof-mac 0` | р╕Ыр╕ер╕нр╕б MAC address р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕б |
| `-S <IP>` | р╕Ыр╕ер╕нр╕б source IP (р╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕З routing р╕Фр╣Йр╕зр╕в) |
| `-Pn` | р╣Др╕бр╣Ир╕кр╣Ир╕З ICMP ping тЖТ р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Чр╕╡р╣И block ping |
| `--source-port <port>` | р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ port р╕Хр╣Йр╕Щр╕Чр╕▓р╕З р╣Ар╕Кр╣Ир╕Щ 53 р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕нр╕Бр╣Ар╕Ыр╣Зр╕Щ DNS |

---

## ЁЯзи р╕гр╕зр╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З

### ЁЯФе р╕кр╣Бр╕Бр╕Щр╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Х + OS + Service + version

```bash
sudo nmap -sS -p- -sV -O -T4 -Pn <IP>
```

### ЁЯзк р╕Хр╕гр╕зр╕Ир╕лр╕▓ CVE (vuln scan)

```bash
nmap -sV --script vuln <IP>
```

### ЁЯФР р╕Хр╕гр╕зр╕И SSL Certificate

```bash
nmap --script ssl-cert -p 443 <IP>
```

### ЁЯХ╕я╕П р╕Хр╕гр╕зр╕И directory hidden р╕Ър╕Щ web

```bash
nmap --script http-enum -p 80 <IP>
```

### ЁЯзЯ Zombie Scan (idle scan р╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╕Хр╕▒р╕зр╕Ир╕гр╕┤р╕З)

```bash
sudo nmap -sI <zombie_ip> <target_ip>
```

---

## ЁЯз░ р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

- р╣Гр╕Кр╣Й `-oN` р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕ер╕Зр╣Др╕Яр╕ер╣М:
```bash
nmap -sV -oN result.txt <IP>
```

- р╕Др╣Йр╕Щр╕лр╕▓ host р╕Чр╕▒р╣Йр╕З subnet:
```bash
nmap -sn 192.168.1.0/24
```

- р╣Гр╕Кр╣Йр╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Ъ wordlist (р╕Ир╕│р╕Бр╕▒р╕Фр╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕▓р╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в):
```bash
nmap -iL target_list.txt -sV
```

---

## ЁЯУВ р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З NSE Script р╣Ар╕Фр╣Ир╕Щ р╣Ж

| Script | р╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▓р╕гр╕Ц |
|--------|-------------|
| `http-enum` | р╕кр╕│р╕гр╕зр╕И directory/web page р╕Чр╕╡р╣Ир╕Лр╣Ир╕нр╕Щр╕нр╕вр╕╣р╣И |
| `ftp-anon` | р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓ FTP login р╣Бр╕Ър╕Ъ anonymous р╣Др╕Фр╣Йр╣Др╕лр╕б |
| `ssh-auth-methods` | р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓ SSH р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕г auth р╣Бр╕Ър╕Ър╣Гр╕Ф |
| `vuln` | р╕гр╕зр╕бр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕лр╕▓р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕▒р╣Ир╕зр╣Др╕Ы |
| `smb-os-discovery` | р╕Хр╕гр╕зр╕И OS р╕Ьр╣Ир╕▓р╕Щ SMB |
| `ssl-heartbleed` | р╕Хр╕гр╕зр╕Ир╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И Heartbleed |

р╕Др╣Йр╕Щр╕лр╕▓ script р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б:

```bash
ls /usr/share/nmap/scripts/
```

---

## ЁЯза р╣Гр╕Кр╣Йр╣Гр╕Щ CTF р╕лр╕гр╕╖р╕н OSCP р╕вр╕▒р╕Зр╣Др╕З

- р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Б `nmap -sS -p- -T4 -Pn <IP>` тЖТ р╕Фр╕╣р╕зр╣Ир╕▓р╕нр╕░р╣Др╕гр╣Ар╕Ыр╕┤р╕Ф
- р╕Хр╣Ир╕нр╕Фр╣Йр╕зр╕в `-sV -sC` тЖТ р╕Фр╕╣ service р╣Бр╕ер╕░ run script р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
- р╕Цр╣Йр╕▓р╣Ар╕Ыр╣Зр╕Щр╣Ар╕зр╣Зр╕Ъ тЖТ р╣Гр╕Кр╣Й `http-enum`, `http-title`, `http-methods`
- р╕лр╕▓ CVE тЖТ р╣Гр╕Кр╣Й `--script vuln`, р╕лр╕гр╕╖р╕н export service р╣Др╕Ыр╕лр╕▓ PoC р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

---

## ЁЯЫбя╕П р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕нр╕вр╣Ир╕▓р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Ир╕гр╕┤р╕Зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Фр╣Зр╕Фр╕Вр╕▓р╕Ф
- р╕Бр╕▓р╕гр╣Гр╕Кр╣Й script р╕нр╕▓р╕Ир╕Бр╕гр╕░р╕Чр╕Ър╕гр╕░р╕Ър╕Ър╕Ир╕гр╕┤р╕З
- р╕Др╕зр╕гр╣Гр╕Кр╣Йр╣Гр╕Щ lab, CTF р╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕Чр╕╡р╣Ир╕Др╕╕р╕Ур╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ

---

> ЁЯТг Nmap р╣Др╕бр╣Ир╣Гр╕Кр╣Ир╣Бр╕Др╣И scanner тАФ р╕бр╕▒р╕Щр╕Др╕╖р╕нр╣Ар╕гр╕Фр╕▓р╕гр╣Мр╕Вр╕нр╕Зр╕Щр╕▒р╕Бр╣Ар╕Ир╕▓р╕░р╕гр╕░р╕Ър╕Ър╕Чр╕╕р╕Бр╕Др╕Щ  
> р╣Гр╕Кр╣Йр╕Др╕ер╣Ир╕нр╕З = р╣Ар╕лр╣Зр╕Щр╕Чр╕╕р╕Бр╕Чр╕▓р╕Зр╣Ар╕Вр╣Йр╕▓ р╣Гр╕Кр╣Йр╣Др╕бр╣Ир╕Др╕ер╣Ир╕нр╕З = р╣Ар╕Фр╕┤р╕Щр╣Ар╕Вр╣Йр╕▓р╕Бр╕▒р╕Ър╕Фр╕▒р╕Б ЁЯХ╡я╕П
