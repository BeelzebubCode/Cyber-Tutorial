# ЁЯМР Nmap - Network Mapper (Advanced Guide)

> `nmap` р╕Др╕╖р╕нр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╣Бр╕Бр╕Щр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╕бр╕▓р╕Бр╕Чр╕╡р╣Ир╕кр╕╕р╕Фр╣Гр╕Щр╣Вр╕ер╕Б Cyber Security  
> р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х, fingerprint OS/Service, р╕Хр╕гр╕зр╕Ир╕лр╕▓ CVE р╣Бр╕ер╕░р╕лр╕ер╕нр╕Бр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Др╕Фр╣Йр╕Фр╣Йр╕зр╕в

---

## ЁЯУЪ р╕кр╕▓р╕гр╕Ър╕▒р╕Н

### ЁЯУЦ р╕Ър╕Чр╕Щр╕│
- [р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕З Nmap](#р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕З-nmap)
- [р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й Nmap?](#р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й-nmap)

### ЁЯФ░ р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
- [ЁЯз░ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З](#р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З)
- [тЪЩя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы](#р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы)
- [ЁЯУж р╕лр╕бр╕зр╕Ф Option р╕кр╕│р╕Др╕▒р╕Н](#р╕лр╕бр╕зр╕Ф-option-р╕кр╕│р╕Др╕▒р╕Н)
  - [ЁЯзк р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ (Scan Type)](#р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ-scan-type)
  - [ЁЯМР Target & Port](#target--port)
  - [ЁЯФН Service Detection](#service-detection)
  - [ЁЯза OS Detection](#os-detection)
  - [ЁЯЪА Speed & Timing (-T)](#speed--timing--t)
  - [ЁЯУД р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М](#р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М)

### ЁЯза р╕гр╕░р╕Фр╕▒р╕Ър╕Бр╕ер╕▓р╕Зр╕Цр╕╢р╕Зр╕кр╕╣р╕З
- [ЁЯХ╡я╕ПтАНтЩВя╕П Spoofing & Evasion with Nmap](#spoofing--evasion-with-nmap)
- [ЁЯзЯ Zombie Scan (Idle Scan)](#zombie-scan-idle-scan)
- [ЁЯОн Firewall Evasion Techniques](#firewall-evasion-techniques)
- [ЁЯзк NSE Script Deep Dive](#nse-script-deep-dive)
- [ЁЯФН OS Fingerprinting Techniques](#os-fingerprinting-techniques)
- [ЁЯзи р╕гр╕зр╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З](#р╕гр╕зр╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З)
- [ЁЯУВ р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З NSE Script р╣Ар╕Фр╣Ир╕Щ р╣Ж](#р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З-nse-script-р╣Ар╕Фр╣Ир╕Щ-р╣Ж)
- [ЁЯз░ р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ](#р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ)
- [ЁЯза р╣Гр╕Кр╣Йр╣Гр╕Щ CTF р╕лр╕гр╕╖р╕н OSCP р╕вр╕▒р╕Зр╣Др╕З](#р╣Гр╕Кр╣Йр╣Гр╕Щ-ctf-р╕лр╕гр╕╖р╕н-oscp-р╕вр╕▒р╕Зр╣Др╕З)
- [ЁЯЫбя╕П р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕](#р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕)

---

## ЁЯУЦ р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕З Nmap
Nmap (Network Mapper) р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╣Вр╕нр╣Ар╕Юр╕Щр╕Лр╕нр╕гр╣Мр╕кр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕│р╕гр╕зр╕Ир╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в р╕бр╕▒р╕Щр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х, р╕гр╕░р╕Ър╕╕р╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕г, р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ service version р╣Бр╕ер╕░р╕Др╣Йр╕Щр╕лр╕▓р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Хр╣Ир╕▓р╕З р╣Ж р╣Др╕Фр╣Й

## ЁЯУЦ р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й Nmap?
- р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Зр╣Ир╕▓р╕вр╣Бр╕ер╕░р╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щ
- р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Вр╕▒р╣Йр╕Щр╕кр╕╣р╕З (stealth, spoofing, zombie)
- р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щр╣Гр╕Щр╕зр╕Зр╕Бр╕▓р╕г Pentest/CTF/SOC

---

## ЁЯз░ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З
```bash
sudo apt update
sudo apt install nmap
```

## тЪЩя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы
```bash
nmap [TARGET] [OPTIONS]
```
**р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:**
```bash
nmap -sS -p- -sV -O -T4 -Pn <IP>
```

---

## ЁЯУж р╕лр╕бр╕зр╕Ф Option р╕кр╕│р╕Др╕▒р╕Н

### ЁЯзк р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ (Scan Type)
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-sS` | SYN Scan (Stealth) тЬЕ р╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕вр╕Чр╕╡р╣Ир╕кр╕╕р╕Ф |
| `-sT` | TCP Connect Scan (р╣Гр╕Кр╣Йр╣Ар╕бр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕Кр╣Й root) |
| `-sU` | UDP Scan |
| `-sN` | Null Scan (р╣Др╕бр╣Ир╕бр╕╡ flag) |
| `-sF` | FIN Scan |
| `-sX` | Xmas Scan |

### ЁЯМР Target & Port
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-p-` | р╕кр╣Бр╕Бр╕Щр╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Х |
| `-p 22,80,443` | р╕кр╣Бр╕Бр╕Щр╣Ар╕Йр╕Юр╕▓р╕░р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕ |
| `-F` | р╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕вр╕нр╕Фр╕Щр╕┤р╕вр╕б (100 р╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕гр╕Б) |

### ЁЯФН Service Detection
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-sV` | р╕Хр╕гр╕зр╕И version р╕Вр╕нр╕З service |
| `--version-intensity <0-9>` | р╕Др╕зр╕▓р╕бр╕ер╕╢р╕Бр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕И (default: 7) |

### ЁЯза OS Detection
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-O` | р╕Хр╕гр╕зр╕Ир╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕г (OS Fingerprint) |
| `--osscan-guess` | р╣Ар╕Фр╕▓ OS р╣Бр╕бр╣Йр╣Др╕бр╣Ир╣Бр╕Щр╣Ир╕Щр╕нр╕Щ |

### ЁЯЪА Speed & Timing (-T)
| Level | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|-------|-----------|
| `-T0` | Paranoid тЖТ р╕Кр╣Йр╕▓р╕Чр╕╡р╣Ир╕кр╕╕р╕Ф (р╣Ар╕ер╕╡р╣Ир╕вр╕З IDS) |
| `-T1` | Sneaky |
| `-T2` | Polite |
| `-T3` | Normal (default) |
| `-T4` | Aggressive тЖТ р╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕в |
| `-T5` | Insane тЖТ р╣Ар╕гр╣Зр╕зр╕кр╕╕р╕Ф р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Вр╕Фр╕Щр╕Ир╕▒р╕Ъ |

### ЁЯУД р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-oN file.txt` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щ text р╣Бр╕Ър╕Ър╕нр╣Ир╕▓р╕Щр╕Зр╣Ир╕▓р╕в |
| `-oX file.xml` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щ XML (р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕нр╕╖р╣Ир╕Щ) |
| `-oG file.gnmap` | Grepable Format |
| `-oA prefix` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Чр╕╕р╕Бр╕Яр╕нр╕гр╣Мр╣Бр╕бр╕Х (`prefix.nmap`, `.xml`, `.gnmap`) |

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
nmap -sV -oA result <target>
```

---

## ЁЯХ╡я╕ПтАНтЩВя╕П Spoofing & Evasion with Nmap
р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕лр╕ер╕нр╕Бр╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ъ (IDS/Firewall) р╕Фр╣Йр╕зр╕вр╕Бр╕▓р╕гр╕Ыр╕ер╕нр╕бр╣Бр╕Ыр╕ер╕Зр╕Юр╕др╕Хр╕┤р╕Бр╕гр╕гр╕б:

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|-----------|
| `-D RND:10` | р╕кр╕гр╣Йр╕▓р╕З IP р╕Ыр╕ер╕нр╕б (decoy) 10 IP р╕гр╕зр╕бр╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕Фр╣Йр╕зр╕в р╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╕┤р╕Фр╕Ър╕▒р╕Зр╕Хр╕▒р╕зр╕Ир╕гр╕┤р╕З |
| `--spoof-mac 0` | р╕Ыр╕ер╕нр╕б MAC address р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕б |
| `-S <IP>` | р╕Ыр╕ер╕нр╕б Source IP (р╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕З routing р╕Бр╕ер╕▒р╕Ъ) |
| `-Pn` | р╣Др╕бр╣Ир╕кр╣Ир╕З ICMP ping р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З block ping |
| `--source-port 53` | р╣Гр╕Кр╣Йр╕Юр╕нр╕гр╣Мр╕Хр╕Хр╣Йр╕Щр╕Чр╕▓р╕З 53 (р╣Ар╕лр╕бр╕╖р╕нр╕Щ DNS) р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕нр╕Б firewall |

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
sudo nmap -sS -Pn -D RND:10 --spoof-mac 0 --source-port 53 10.10.234.123
```

---

## ЁЯзЯ Zombie Scan (Idle Scan)
р╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╣Бр╕Ър╕Ър╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╕Хр╕▒р╕з р╣Вр╕Фр╕вр╣Гр╕Кр╣Й IP р╕нр╕╖р╣Ир╕Щ (Zombie) р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Бр╕ер╕▓р╕Зр╣Гр╕Щр╕Бр╕▓р╕г probe port р╕Ър╕Щр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в

```bash
sudo nmap -sI <zombie_ip> <target_ip>
```

Zombie р╕Хр╣Йр╕нр╕З:
- р╕бр╕╡ IP ID predictable
- traffic р╕Щр╣Йр╕нр╕в (idle)
- р╕гр╕▒р╕Ъ packet р╕Ир╕▓р╕Бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Др╕Фр╣Й

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
sudo nmap -sI 192.168.1.100 10.10.10.20
```

---

> тЬЕ р╕Юр╕гр╣Йр╕нр╕бр╣Ар╕Хр╕┤р╕бр╕лр╕▒р╕зр╕Вр╣Йр╕нр╕гр╕░р╕Фр╕▒р╕Ър╕кр╕╣р╕Зр╕Цр╕▒р╕Фр╣Др╕Ы р╣Ар╕Кр╣Ир╕Щ Firewall Evasion, NSE Script, Fingerprint Techniques...
