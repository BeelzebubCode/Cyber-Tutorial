# ЁЯМР Nmap - Network Mapper (Advanced Guide)

> `nmap` р╕Др╕╖р╕нр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╣Бр╕Бр╕Щр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╕бр╕▓р╕Бр╕Чр╕╡р╣Ир╕кр╕╕р╕Фр╣Гр╕Щр╣Вр╕ер╕Б Cyber Security  
> р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х, fingerprint OS/Service, р╕Хр╕гр╕зр╕Ир╕лр╕▓ CVE р╣Бр╕ер╕░р╕лр╕ер╕нр╕Бр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Др╕Фр╣Йр╕Фр╣Йр╕зр╕в

---

## ЁЯУЪ р╕кр╕▓р╕гр╕Ър╕▒р╕Н

### ЁЯУЦ р╕Ър╕Чр╕Щр╕│
- [ЁЯУЦ р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕З Nmap](#-р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕З-nmap)
- [ЁЯУЦ р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й Nmap?](#-р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й-nmap)

### ЁЯФ░ р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
- [ЁЯз░ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З](#-р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З)
- [тЪЩя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы](#-р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы)
- [ЁЯУж р╕лр╕бр╕зр╕Ф Option р╕кр╕│р╕Др╕▒р╕Н](#-р╕лр╕бр╕зр╕Ф-option-р╕кр╕│р╕Др╕▒р╕Н)
  - [ЁЯзк р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ (Scan Type)](#-р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ-scan-type)
  - [ЁЯМР Target & Port](#-target--port)
  - [ЁЯФН Service Detection](#-service-detection)
  - [ЁЯза OS Detection](#-os-detection)
  - [ЁЯЪА Speed & Timing (-T)](#-speed--timing--t)
  - [ЁЯУД р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М](#-р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М)

### ЁЯза р╕гр╕░р╕Фр╕▒р╕Ър╕Бр╕ер╕▓р╕Зр╕Цр╕╢р╕Зр╕кр╕╣р╕З
- [ЁЯХ╡я╕ПтАНтЩВя╕П Spoofing & Evasion with Nmap](#-spoofing--evasion-with-nmap)
- [ЁЯзЯ Zombie Scan (Idle Scan)](#-zombie-scan-idle-scan)
- [ЁЯОн Firewall Evasion Techniques](#-firewall-evasion-techniques)
- [ЁЯзк NSE Script Deep Dive](#-nse-script-deep-dive)
- [ЁЯФН OS Fingerprinting Techniques](#-os-fingerprinting-techniques)
- [ЁЯзи р╕гр╕зр╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З](#-р╕гр╕зр╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З)
- [ЁЯУВ р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З NSE Script р╣Ар╕Фр╣Ир╕Щ р╣Ж](#-р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З-nse-script-р╣Ар╕Фр╣Ир╕Щ-р╣Ж)
- [ЁЯз░ р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ](#-р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ)
- [ЁЯза р╣Гр╕Кр╣Йр╣Гр╕Щ CTF р╕лр╕гр╕╖р╕н OSCP р╕вр╕▒р╕Зр╣Др╕З](#-р╣Гр╕Кр╣Йр╣Гр╕Щ-ctf-р╕лр╕гр╕╖р╕н-oscp-р╕вр╕▒р╕Зр╣Др╕З)
- [тЪЩя╕П р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Зр╕ер╕│р╕Фр╕▒р╕Ъ Option р╕Вр╕нр╕З Nmap (Best Practice for Professionals)](#р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Зр╕ер╕│р╕Фр╕▒р╕Ъ-option-р╕Вр╕нр╕З-nmap)
- [ЁЯУЪ р╕зр╕┤р╕Шр╕╡р╕ир╕╢р╕Бр╕йр╕▓р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б](#-р╕зр╕┤р╕Шр╕╡р╕ир╕╢р╕Бр╕йр╕▓р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б)
- [ЁЯЫбя╕П р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕](#-р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕)

---

## ЁЯУЦ р╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕З Nmap
Nmap (Network Mapper) р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╣Вр╕нр╣Ар╕Юр╕Щр╕Лр╕нр╕гр╣Мр╕кр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕│р╕гр╕зр╕Ир╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в р╕бр╕▒р╕Щр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х, р╕гр╕░р╕Ър╕╕р╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕г, р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ service version р╣Бр╕ер╕░р╕Др╣Йр╕Щр╕лр╕▓р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Хр╣Ир╕▓р╕З р╣Ж р╣Др╕Фр╣Й

## ЁЯУЦ р╕Чр╕│р╣Др╕бр╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й Nmap?
- р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Зр╣Ир╕▓р╕вр╣Бр╕ер╕░р╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щ
- р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Вр╕▒р╣Йр╕Щр╕кр╕╣р╕З (stealth, spoofing, zombie)
- р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щр╣Гр╕Щр╕зр╕Зр╕Бр╕▓р╕г Pentest/CTF/SOC

---

## ЁЯз░ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З
```bash
sudo apt update
sudo apt install nmap
```

## тЪЩя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕▒р╣Ир╕зр╣Др╕Ы
```bash
nmap [TARGET] [OPTIONS]
```
**р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:**
```bash
nmap -sS -p- -sV -O -T4 -Pn <IP>
```

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯУж р╕лр╕бр╕зр╕Ф Option р╕кр╕│р╕Др╕▒р╕Н

### ЁЯзк р╣Вр╕лр╕бр╕Фр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ (Scan Type)
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-sS` | SYN Scan (Stealth) тЬЕ р╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕вр╕Чр╕╡р╣Ир╕кр╕╕р╕Ф |
| `-sT` | TCP Connect Scan (р╣Гр╕Кр╣Йр╣Ар╕бр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕Кр╣Й root) |
| `-sU` | UDP Scan |
| `-sN` | Null Scan (р╣Др╕бр╣Ир╕бр╕╡ flag) |
| `-sF` | FIN Scan |
| `-sX` | Xmas Scan |

### ЁЯМР Target & Port
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-p-` | р╕кр╣Бр╕Бр╕Щр╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Х |
| `-p 22,80,443` | р╕кр╣Бр╕Бр╕Щр╣Ар╕Йр╕Юр╕▓р╕░р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕ |
| `-F` | р╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕вр╕нр╕Фр╕Щр╕┤р╕вр╕б (100 р╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕гр╕Б) |

### ЁЯФН Service Detection
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-sV` | р╕Хр╕гр╕зр╕И version р╕Вр╕нр╕З service |
| `--version-intensity <0-9>` | р╕Др╕зр╕▓р╕бр╕ер╕╢р╕Бр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕И (default: 7) |

### ЁЯза OS Detection
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-O` | р╕Хр╕гр╕зр╕Ир╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕г (OS Fingerprint) |
| `--osscan-guess` | р╣Ар╕Фр╕▓ OS р╣Бр╕бр╣Йр╣Др╕бр╣Ир╣Бр╕Щр╣Ир╕Щр╕нр╕Щ |

### ЁЯЪА Speed & Timing (-T)
| Level | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|-------|-----------|
| `-T0` | Paranoid тЖТ р╕Кр╣Йр╕▓р╕Чр╕╡р╣Ир╕кр╕╕р╕Ф (р╣Ар╕ер╕╡р╣Ир╕вр╕З IDS) |
| `-T1` | Sneaky |
| `-T2` | Polite |
| `-T3` | Normal (default) |
| `-T4` | Aggressive тЖТ р╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕в |
| `-T5` | Insane тЖТ р╣Ар╕гр╣Зр╕зр╕кр╕╕р╕Ф р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Вр╕Фр╕Щр╕Ир╕▒р╕Ъ |

### ЁЯУД р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-oN file.txt` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щ text р╣Бр╕Ър╕Ър╕нр╣Ир╕▓р╕Щр╕Зр╣Ир╕▓р╕в |
| `-oX file.xml` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щ XML (р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕нр╕╖р╣Ир╕Щ) |
| `-oG file.gnmap` | Grepable Format |
| `-oA prefix` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Чр╕╕р╕Бр╕Яр╕нр╕гр╣Мр╣Бр╕бр╕Х (`prefix.nmap`, `.xml`, `.gnmap`) |

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
nmap -sV -oA result <target>
```

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯХ╡я╕ПтАНтЩВя╕П Spoofing & Evasion with Nmap

р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕лр╕ер╕нр╕Бр╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ъ (IDS/Firewall) р╕Фр╣Йр╕зр╕вр╕Бр╕▓р╕гр╕Ыр╕ер╕нр╕бр╣Бр╕Ыр╕ер╕Зр╕Юр╕др╕Хр╕┤р╕Бр╕гр╕гр╕б:

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|-----------|
| `-D RND:10` | р╕кр╕гр╣Йр╕▓р╕З IP р╕Ыр╕ер╕нр╕б (decoy) 10 IP р╕гр╕зр╕бр╕Вр╕нр╕Зр╣Ар╕гр╕▓р╕Фр╣Йр╕зр╕в р╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╕┤р╕Фр╕Ър╕▒р╕Зр╕Хр╕▒р╕зр╕Ир╕гр╕┤р╕З |
| `--spoof-mac 0` | р╕Ыр╕ер╕нр╕б MAC address р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕б |
| `-S <IP>` | р╕Ыр╕ер╕нр╕б Source IP (р╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕З routing р╕Бр╕ер╕▒р╕Ъ) |
| `-Pn` | р╣Др╕бр╣Ир╕кр╣Ир╕З ICMP ping р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З block ping |
| `--source-port 53` | р╣Гр╕Кр╣Йр╕Юр╕нр╕гр╣Мр╕Хр╕Хр╣Йр╕Щр╕Чр╕▓р╕З 53 (р╣Ар╕лр╕бр╕╖р╕нр╕Щ DNS) р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕нр╕Б firewall |

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
sudo nmap -sS -Pn -D RND:10 --spoof-mac 0 --source-port 53 10.10.234.123
```

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯзЯ Zombie Scan (Idle Scan)

> Zombie Scan р╕лр╕гр╕╖р╕н Idle Scan р╣Ар╕Ыр╣Зр╕Щр╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕Ър╕Ъ **р╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╕Хр╕▒р╕зр╕Хр╕Щ** р╣Вр╕Фр╕вр╣Гр╕Кр╣Йр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕нр╕╖р╣Ир╕Щ (Zombie) р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕Бр╕ер╕▓р╕Зр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ
> р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Щр╕╡р╣Йр╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Вр╕Ир╕бр╕Хр╕╡р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕в IP р╕Ир╕гр╕┤р╕Зр╣Гр╕лр╣Йр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Ар╕лр╣Зр╕Щр╣Ар╕ер╕вр╣Бр╕бр╣Йр╣Бр╕Хр╣Ир╕Щр╣Йр╕нр╕в

### ЁЯза р╣Бр╕Щр╕зр╕Др╕┤р╕Ф

р╣Бр╕Чр╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Ир╕З packet р╣Др╕Ыр╕вр╕▒р╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Вр╕Фр╕вр╕Хр╕гр╕З (р╕Лр╕╢р╣Ир╕Зр╕нр╕▓р╕Ир╕Цр╕╣р╕Б firewall, IDS, р╕лр╕гр╕╖р╕н log р╕Ир╕▒р╕Ър╣Др╕Фр╣Й)  
р╣Ар╕гр╕▓р╕Бр╕ер╕▒р╕Ър╣Гр╕лр╣Й **Zombie** р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╕кр╣Ир╕З probe р╣Др╕Ыр╣Бр╕Чр╕Щ

р╣Ар╕гр╕▓р╕Др╕зр╕Ър╕Др╕╕р╕б Zombie р╕Фр╣Йр╕зр╕в packet р╕Юр╕┤р╣Ар╕ир╕й р╣Бр╕ер╕░р╕кр╕▒р╕Зр╣Ар╕Бр╕Хр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╣Ар╕ер╣Зр╕Б р╣Ж р╕Щр╣Йр╕нр╕в р╣Ж р╣Гр╕Щр╕Юр╕др╕Хр╕┤р╕Бр╕гр╕гр╕бр╕Вр╕нр╕Зр╕бр╕▒р╕Щ р╣Ар╕Кр╣Ир╕Щ **IP ID field** р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Фр╕▓р╕зр╣Ир╕▓р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Ар╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Хр╕лр╕гр╕╖р╕нр╣Др╕бр╣И

### ЁЯФз р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
```bash
sudo nmap -sI <zombie_ip> <target_ip>
```

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
sudo nmap -sI 10.10.10.50 10.10.10.20
```
- `10.10.10.50` р╕Др╕╖р╕н Zombie (р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╕бр╕╡ IP ID predictable)
- `10.10.10.20` р╕Др╕╖р╕н Target р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕кр╣Бр╕Бр╕Щ

### ЁЯФН р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕лр╕ер╕▒р╕З
1. **р╣Ар╕гр╕▓р╕кр╣Ир╕З probe р╣Др╕Ыр╕лр╕▓ Zombie** р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Др╣Ир╕▓ IP ID р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щр╕Вр╕нр╕Зр╕бр╕▒р╕Щ
2. **р╣Ар╕гр╕▓р╕кр╕▒р╣Ир╕З Zombie р╣Др╕Ыр╣Ар╕Ыр╕┤р╕Ф connection р╕Бр╕▒р╕Ъ Target**
3. **Target р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ** р╣Др╕Ыр╕лр╕▓ Zombie (р╕Цр╣Йр╕▓ port open р╕Ир╕░р╕кр╣Ир╕З SYN-ACK, р╕Цр╣Йр╕▓ closed р╕Ир╕░р╕кр╣Ир╕З RST)
4. **Zombie р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Гр╕лр╣Йр╣Ар╕гр╕▓р╣Ар╕лр╣Зр╕Щ IP ID р╣Гр╕лр╕бр╣И**
5. р╣Ар╕гр╕▓р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕зр╣Ир╕▓ IP ID р╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╕╢р╣Йр╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И тЖТ р╕Цр╣Йр╕▓р╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╕╢р╣Йр╕Щ = port р╕Щр╕▒р╣Йр╕Щ "open"

### тЬЕ р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕Чр╕╡р╣И Zombie р╕Хр╣Йр╕нр╕Зр╕бр╕╡

| р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В | р╣Ар╕лр╕Хр╕╕р╕Ьр╕е |
|----------|--------|
| ЁЯЯв р╕бр╕╡ IP ID р╕Чр╕╡р╣И predictable | р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Фр╕╣р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╕лр╕ер╕▒р╕Зр╕кр╣Ир╕З packet |
| ЁЯЯв р╕бр╕╡ traffic р╕Хр╣Ир╕│ (idle) | р╣Др╕бр╣Ир╕Зр╕▒р╣Йр╕Щ IP ID р╕Ир╕░р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕нр╕Зр╕Хр╕ер╕нр╕Фр╣Ар╕зр╕ер╕▓ |
| ЁЯЯв р╣Ар╕Ыр╕┤р╕Ф TCP port (р╣Ар╕Кр╣Ир╕Щ 80) | р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Ар╕гр╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕н Zombie р╣Др╕Фр╣Й |
| ЁЯЯв р╕нр╕вр╕╣р╣Ир╣Гр╕Щ subnet р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Др╕зр╕Ър╕Др╕╕р╕б р╕лр╕гр╕╖р╕н reachable | Zombie р╕Хр╣Йр╕нр╕З reachable р╣Бр╕ер╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕▒р╕Ъ packet р╕Ир╕▓р╕Бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Др╕Фр╣Й |

### ЁЯзк р╕лр╕▓ Zombie р╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?
р╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕З:
```bash
nmap -Pn -O -p 80 <ip>
```
- р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓р╣Ар╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х TCP р╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Др╕Фр╣Й
- р╕Хр╣Йр╕нр╕Зр╕ер╕нр╕Зр╕лр╕ер╕▓р╕в IP р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Чр╕╡р╣И idle р╕Ир╕гр╕┤р╕З р╣Ж

### ЁЯТб р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Хр╣Зр╕бр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
```bash
sudo nmap -sI 192.168.1.100 10.10.10.20
```
р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М:
```
Interesting ports on 10.10.10.20:
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```
тЖТ р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Др╕бр╣Ир╕гр╕╣р╣Йр╣Ар╕ер╕вр╕зр╣Ир╕▓ "р╣Ар╕гр╕▓р╕Др╕╖р╕нр╣Гр╕Др╕г" р╣Ар╕Юр╕гр╕▓р╕░ packet р╕бр╕▓р╕Ир╕▓р╕Б 192.168.1.100

### ЁЯзй р╕Ыр╕гр╕░р╣Вр╕вр╕Кр╕Щр╣Мр╕Вр╕нр╕З Zombie Scan

| р╕Вр╣Йр╕нр╕Фр╕╡ | р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф |
|-------|-------------|
| ЁЯХ╡я╕ПтАНтЩВя╕П **Stealth** | р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Др╕бр╣Ир╣Ар╕лр╣Зр╕Щ IP р╣Ар╕гр╕▓ |
| ЁЯЫбя╕П **Bypass Firewall/IDS** | р╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╣Вр╕вр╕Зр╕Бр╕▒р╕Ъ IP р╣Ар╕гр╕▓р╣Др╕Фр╣Й |
| ЁЯТе **р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ъ Target р╕кр╕│р╕Др╕▒р╕Нр╣Др╕Фр╣Й** | р╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╕Чр╕╡р╣И log р╕Чр╕╕р╕Б connection |

### тЪая╕П р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Ф

| р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Ф | р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф |
|----------|-------------|
| тЭМ р╕лр╕▓ Zombie р╕Чр╕╡р╣Ир╕Фр╕╡р╣Др╕Фр╣Йр╕вр╕▓р╕Б | Zombie р╕Хр╣Йр╕нр╕З idle р╣Бр╕ер╕░ predictable р╕Ир╕гр╕┤р╕З р╣Ж |
| тЭМ Zombie р╕Хр╣Йр╕нр╕З reachable р╕Ир╕▓р╕Бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в | р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Хр╣Йр╕нр╕Зр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕З response р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕вр╕▒р╕З Zombie |
| тЭМ IP ID р╕Цр╕╣р╕Бр╕кр╕╕р╣Ир╕бр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╣Гр╕лр╕бр╣И р╣Ж | OS р╣Гр╕лр╕бр╣Ир╕бр╕▒р╕Бр╕кр╕╕р╣Ир╕б IP ID тЖТ Zombie р╣Др╕бр╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б |
| тЭМ р╕Кр╣Йр╕▓ | р╕Хр╣Йр╕нр╕Зр╕Ир╕▒р╕Ър╕лр╕ер╕▓р╕вр╕гр╕нр╕Ър╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣ IP ID change |

### ЁЯЪи р╕Вр╣Йр╕нр╕Др╕зр╕гр╕гр╕░р╕зр╕▒р╕З
- р╕нр╕вр╣Ир╕▓р╣Гр╕Кр╣Йр╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Щр╕╡р╣Йр╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕Ир╕гр╕┤р╕Зр╕Чр╕╡р╣Ир╕Др╕╕р╕У **р╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣М**
- р╣Гр╕Кр╣Йр╣Гр╕Щ CTF / TryHackMe / HackTheBox р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ
- Zombie р╕Др╕зр╕гр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╕Чр╕╡р╣Ир╕Др╕╕р╕Ур╕Др╕зр╕Ър╕Др╕╕р╕бр╣Др╕Фр╣Й р╣Ар╕Кр╣Ир╕Щ lab, VM, р╕лр╕гр╕╖р╕н subnet р╕Ыр╕ер╕нр╕б

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---
## ЁЯОн Firewall Evasion Techniques

> р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З Firewall р╣Бр╕ер╕░р╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ъ (IDS/IPS) р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕лр╕гр╕╖р╕нр╕Ър╕гр╕┤р╕Бр╕▓р╕гр╣Др╕Фр╣Йр╕кр╕│р╣Ар╕гр╣Зр╕И

### ЁЯФз р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╣Бр╕ер╕░р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Др╕Фр╣Й

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-f` | Fragment packet тЖТ р╣Бр╕Ър╣Ир╕З packet р╕нр╕нр╕Бр╣Ар╕Ыр╣Зр╕Щр╕Кр╕┤р╣Йр╕Щр╣Ар╕ер╣Зр╕Б р╣Ж р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕Ъ firewall, р╕Чр╕│р╣Гр╕лр╣Й IDS р╕вр╕▓р╕Бр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╕ер╕│р╕Фр╕▒р╕Ъ packet р╕Чр╕╡р╣Ир╣Бр╕Чр╣Йр╕Ир╕гр╕┤р╕З |
| `--mtu <val>` | р╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕Щр╕▓р╕Ф MTU (Maximum Transmission Unit) тЖТ р╕Ыр╕Бр╕Хр╕┤р╣Гр╕Кр╣Й 8, 16, 32, 64 р╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╣Гр╕лр╣Й fragment packet |
| `--data-length <len>` | р╣Гр╕кр╣Ир╕Вр╣Йр╕нр╕бр╕╣р╕е padding р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╣Гр╕Щ packet р╣Ар╕Кр╣Ир╕Щ 50, 100, 200 byte р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ signature р╕Вр╕нр╕З packet |
| `--ttl <val>` | р╕Ыр╕гр╕▒р╕Ър╕Др╣Ир╕▓ TTL (Time To Live) р╣Ар╕Кр╣Ир╕Щ 1тАУ255 тЖТ р╣Гр╕Кр╣Йр╕лр╕ер╕Ъ routing path р╕лр╕гр╕╖р╕н signature IDS р╕Чр╕╡р╣И filter р╕Хр╕▓р╕б TTL р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕в |
| `--source-port <port>` | р╕Бр╕│р╕лр╕Щр╕Фр╕Юр╕нр╕гр╣Мр╕Хр╕Хр╣Йр╕Щр╕Чр╕▓р╕Зр╕Вр╕нр╕З packet р╣Ар╕Кр╣Ир╕Щ 53 (DNS), 123 (NTP), 443 (HTTPS) р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕нр╕Б firewall р╣Гр╕лр╣Йр╕Др╕┤р╕Фр╕зр╣Ир╕▓р╕бр╕▓р╕Ир╕▓р╕Б traffic р╕Ыр╕Бр╕Хр╕┤ |
| `-D RND:10` | р╕кр╕гр╣Йр╕▓р╕З IP р╕Ыр╕ер╕нр╕б 10 IP р╣Вр╕Фр╕вр╕кр╕╕р╣Ир╕б (random) р╣Ар╕Ыр╣Зр╕Щ decoy тЖТ р╕Кр╣Ир╕зр╕вр╕Бр╕ер╕Ъ IP р╕Ьр╕╣р╣Йр╣Вр╕Ир╕бр╕Хр╕╡р╕Ир╕гр╕┤р╕З |
| `--spoof-mac <mac|0>` | р╕Ыр╕ер╕нр╕б MAC address тЖТ р╣Гр╕кр╣И `0` р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕кр╕╕р╣Ир╕бр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤ р╣Ар╕Кр╣Ир╕Щ `--spoof-mac 0`, р╕лр╕гр╕╖р╕нр╕Бр╕│р╕лр╕Щр╕Фр╣Бр╕Ър╕Ъ `00:11:22:33:44:55` |
| `--badsum` | р╕кр╣Ир╕З packet р╕Чр╕╡р╣Ир╕бр╕╡ checksum р╕Ьр╕┤р╕Фр╕Ир╕Зр╣Гр╕И тЖТ IDS р╕Ър╕▓р╕Зр╕Хр╕▒р╕зр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╕гр╕зр╕И checksum р╕Чр╕│р╣Гр╕лр╣Йр╕лр╕ер╕нр╕Бр╣Др╕Фр╣Йр╕зр╣Ир╕▓р╣Ар╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Х |
| `--randomize-hosts` | р╕кр╕╕р╣Ир╕бр╕ер╕│р╕Фр╕▒р╕Ър╕Вр╕нр╕З IP р╕Чр╕╡р╣Ир╕кр╣Бр╕Бр╕Щ тЖТ р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ IDS р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ъ pattern р╣Ар╕Кр╣Ир╕Щр╣Ар╕гр╕╡р╕вр╕З IP р╕Чр╕╡р╕ер╕░р╕Хр╕▒р╕з |
| `--scan-delay <t>` | р╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕зр╕ер╕▓р╕лр╕Щр╣Ир╕зр╕Зр╕гр╕░р╕лр╕зр╣Ир╕▓р╕З probe тЖТ р╣Ар╕Кр╣Ир╕Щ `--scan-delay 100ms` р╕лр╕гр╕╖р╕н `--scan-delay 1s` р╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Ф rate р╣Гр╕лр╣Й stealth р╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щ |

### ЁЯУК р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕вр╣Гр╕Щ <val>, <t>, <len>

| Parameter | р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Др╕Фр╣Й | р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ |
|-----------|------------------|----------|
| `--mtu` | `8`, `16`, `32`, `64` | р╕Хр╣Ир╕│р╕ер╕З = fragment р╣Ар╕вр╕нр╕░р╕Вр╕╢р╣Йр╕Щ (stealth р╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щ р╣Бр╕Хр╣Ир╕Кр╣Йр╕▓р╕ер╕З) |
| `--data-length` | `50`, `100`, `200` | р╕вр╕┤р╣Ир╕Зр╕бр╕▓р╕Бр╕вр╕┤р╣Ир╕Зр╣Ар╕Ър╕╡р╣Ир╕вр╕З signature р╣Др╕Фр╣Йр╕Фр╕╡ |
| `--ttl` | `65`, `128`, `255` | р╕Ър╕▓р╕З IDS р╣Гр╕Кр╣Й TTL р╣Ар╕Ыр╣Зр╕Щ signature detection |
| `--scan-delay` | `100ms`, `500ms`, `1s`, `5s` | р╣Гр╕Кр╣Йр╣Ар╕Юр╕╖р╣Ир╕н bypass rate-limiting firewall/IPS |
| `--source-port` | `53`, `80`, `123`, `443` | р╣Ар╕ер╕╡р╕вр╕Щр╣Бр╕Ър╕Ъ traffic р╕Ыр╕Бр╕Хр╕┤ р╣Ар╕Кр╣Ир╕Щ DNS, HTTP, HTTPS |

### ЁЯТб р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:
- р╣Бр╕Щр╕░р╕Щр╕│р╣Гр╕лр╣Йр╣Гр╕Кр╣Йр╕Др╕╣р╣Ир╕Бр╕▒р╕Ъ `-sS` (SYN Scan) р╣Бр╕ер╕░ `-Pn` (No Ping) р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕Ъ ICMP Block
- р╕Др╕зр╕гр╕Чр╕Фр╕ер╕нр╕Зр╕Ър╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З Lab р╕Бр╣Ир╕нр╕Щр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З
- р╕Ър╕▓р╕З firewall р╕лр╕гр╕╖р╕н IPS р╕Чр╕╡р╣Ир╕бр╕╡ Deep Packet Inspection (DPI) р╕нр╕▓р╕Ир╕вр╕▒р╕Зр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Др╕Фр╣Й

### ЁЯзк р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Кр╕╕р╕Фр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕лр╕ер╕Ъ firewall:
```bash
sudo nmap -sS -Pn -f --mtu 16 --data-length 50 --ttl 65 --source-port 53 -D RND:10 <target-ip>
```

> ЁЯФТ р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Чр╕│ Recon р╣Гр╕Щр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Ыр╕┤р╕Фр╕Ър╕▒р╕Зр╕Хр╕▒р╕зр╕Хр╕Щр╕лр╕гр╕╖р╕нр╕лр╕ер╕Ър╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ър╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ

### тЪая╕П р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:
- Firewall р╕Ър╕▓р╕Зр╕Хр╕▒р╕зр╕кр╕▓р╕бр╕▓р╕гр╕Ц reassemble fragmented packet р╣Др╕Фр╣Й тЖТ р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Щр╕╡р╣Йр╕нр╕▓р╕Ир╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Ьр╕ер╣Ар╕кр╕бр╕нр╣Др╕Ы
- р╕Ър╕▓р╕Зр╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕нр╕▓р╕Ир╣Гр╕Кр╣Йр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╕кр╕бр╕▒р╕вр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╕бр╕╡ Deep Packet Inspection (DPI)

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯзк NSE Script Deep Dive

> Nmap Scripting Engine (NSE) р╕Др╕╖р╕нр╕гр╕░р╕Ър╕Ър╕Чр╕╡р╣Ир╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Й Nmap р╕Чр╕│р╕Зр╕▓р╕Щр╕бр╕▓р╕Бр╕Бр╕зр╣Ир╕▓р╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х р╣Ар╕Кр╣Ир╕Щ р╕Хр╕гр╕зр╕Ир╕лр╕▓ CVE, р╕Хр╕гр╕зр╕И SSL, р╕Хр╕гр╕зр╕И auth method р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щ

> ЁЯУМ NSE Scripts р╕Цр╕╣р╕Бр╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕ар╕▓р╕йр╕▓ *[Lua](https://www.lua.org/)* р╕Лр╕╢р╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щр╕ар╕▓р╕йр╕▓ lightweight р╕Чр╕╡р╣Ир╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╣Ар╕гр╣Зр╕зр╣Бр╕ер╕░р╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Эр╕▒р╕Зр╣Гр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕нр╕вр╣Ир╕▓р╕З Nmap

### ЁЯУБ р╕лр╕бр╕зр╕Ф script р╕лр╕ер╕▒р╕Б р╣Ж

| р╕лр╕бр╕зр╕Ф | р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З script |
|------|----------------|
| auth | ssh-auth-methods, ftp-anon |
| vuln | http-vuln-cve2006-3392, smb-vuln-ms17-010 |
| default | р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ъ `-sC` р╣Ар╕Кр╣Ир╕Щ dns-brute, http-title |
| discovery | smb-os-discovery, dns-service-discovery |
| safe | ssl-cert, whois |

### ЁЯУМ р╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
```bash
nmap -sV --script vuln <IP>
nmap --script ssl-cert -p 443 <IP>
nmap --script ftp-anon -p 21 <IP>
```

### ЁЯФО р╕Фр╕╣ script р╕Чр╕╡р╣Ир╕бр╕╡р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
```bash
ls /usr/share/nmap/scripts/
```

### тЬПя╕П р╣Ар╕Вр╕╡р╕вр╕Щ script р╣Ар╕нр╕З
р╣Др╕Яр╕ер╣Мр╕Хр╣Йр╕нр╕Зр╕ер╕Зр╕Чр╣Йр╕▓р╕в `.nse` р╣Бр╕ер╕░р╕нр╕вр╕╣р╣Ир╣Гр╕Щ `/usr/share/nmap/scripts/`

р╕Фр╕╣р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З script:
```lua
id = "custom-script"
description = [[
  р╕Хр╕гр╕зр╕Ир╕лр╕▓ banner р╕Вр╕нр╕З HTTP server
]]
author = "You"
license = "Same as Nmap"

portrule = shortport.http

action = function(host, port)
  return "Server banner: " .. http.get(host, port).header.server
end
```

р╕Ир╕▓р╕Бр╕Щр╕▒р╣Йр╕Щр╕кр╕▒р╣Ир╕З:
```bash
nmap --script custom-script <IP>
```

### ЁЯза р╣Гр╕Кр╣Й NSE р╕вр╕▒р╕Зр╣Др╕Зр╣Гр╕лр╣Йр╕Др╕╕р╣Йр╕б
- `--script vuln` тЖТ р╕лр╕▓р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕Хр╣Йр╕Щ
- `--script default` тЖТ р╣Гр╕Кр╣Йр╕Др╕зр╕Ър╕Др╕╣р╣И `-sV` р╣Др╕Фр╣Йр╣Ар╕ер╕в
- р╕гр╕▒р╕Щр╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕▓р╕З script тЖТ р╣Гр╕Кр╣Йр╕Кр╕╖р╣Ир╕н script р╕лр╕гр╕╖р╕нр╕лр╕бр╕зр╕Ф р╣Ар╕Кр╣Ир╕Щ `--script auth,vuln`

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯФН OS Fingerprinting Techniques

> р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕лр╕▓ OS р╕Вр╕нр╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕бр╕╡р╕Др╕зр╕▓р╕бр╕кр╕│р╕Др╕▒р╕Нр╕бр╕▓р╕Бр╣Гр╕Щр╕Бр╕гр╕░р╕Ър╕зр╕Щр╕Бр╕▓р╕г Reconnaissance р╣Ар╕Юр╕╖р╣Ир╕нр╕зр╕▓р╕Зр╣Бр╕Ьр╕Щр╣Вр╕Ир╕бр╕Хр╕╡р╕лр╕гр╕╖р╕нр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Хр╣Ир╕нр╣Др╕Ы

### ЁЯФз р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕лр╕ер╕▒р╕Бр╕Вр╕нр╕З Nmap

| р╕Др╕│р╕кр╕▒р╣Ир╕З | р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в |
|--------|----------|
| `-O` | р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Вр╕Фр╕вр╣Гр╕Кр╣Й TCP/IP stack fingerprinting |
| `--osscan-guess` | р╣Ар╕Фр╕▓ OS р╣Бр╕бр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н (р╕нр╕▓р╕Ир╣Др╕бр╣Ир╣Бр╕бр╣Ир╕Щ) |
| `--osscan-limit` | р╕Ир╕│р╕Бр╕▒р╕Фр╣Ар╕Йр╕Юр╕▓р╕░ host р╕Чр╕╡р╣Ир╕бр╕╡ port р╕Чр╕╡р╣Ир╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Й fingerprint р╣Др╕Фр╣Йр╕Фр╕╡ |

```bash
sudo nmap -O 10.10.10.10
sudo nmap -O --osscan-guess 10.10.10.10
```

### ЁЯФм р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ
Nmap р╕Ир╕░р╣Гр╕Кр╣Йр╕Кр╕╕р╕Ф probe (packet р╕Юр╕┤р╣Ар╕ир╕й) р╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕Зр╕Юр╕нр╕гр╣Мр╕Хр╕Хр╣Ир╕▓р╕З р╣Ж р╣Бр╕ер╣Йр╕зр╕Фр╕╣р╕зр╣Ир╕▓р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕Зр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г р╣Ар╕Кр╣Ир╕Щ:
- р╕Вр╕Щр╕▓р╕Фр╕Вр╕нр╕З TTL
- р╕Вр╕Щр╕▓р╕Ф window size
- р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕кр╕Щр╕нр╕З ICMP
- р╕ер╕▒р╕Бр╕йр╕Ур╕░ TCP flag response

р╕гр╕░р╕Ър╕Ър╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Бр╕Хр╣Ир╕ер╕░р╕Хр╕▒р╕зр╕бр╕╡ тАЬр╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕ЩтАЭ р╕Чр╕╡р╣Ир╕Хр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щ р╣Ар╕Кр╣Ир╕Щ Windows р╕Бр╕▒р╕Ъ Linux р╕Хр╕нр╕Ъ TCP flags р╣Др╕бр╣Ир╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▒р╕Щ

### ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│
- р╕Др╕зр╕гр╣Гр╕Кр╣Йр╕Др╕зр╕Ър╕Др╕╣р╣Ир╕Бр╕▒р╕Ъ `-sS -sV` р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щ
- р╕лр╕▓р╕Бр╣Гр╕Кр╣Й `-O` р╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Ьр╕е р╣Гр╕лр╣Йр╕ер╕нр╕Зр╣Ар╕Ыр╕┤р╕Фр╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б р╣Ар╕Кр╣Ир╕Щ `-p-`
- р╣Гр╕Кр╣Йр╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Ъ `-T4 -Pn` р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З rate-limit/firewall

```bash
sudo nmap -sS -sV -O -Pn -T4 <IP>
```

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯзи р╕гр╕зр╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З

> ЁЯФз р╕лр╕бр╕зр╕Фр╕Щр╕╡р╣Йр╕Др╕╖р╕нр╕Бр╕▓р╕гр╕гр╕зр╕бр╕Кр╕╕р╕Фр╕Др╕│р╕кр╕▒р╣Ир╕З Nmap р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ър╣Ир╕нр╕в р╕Юр╕гр╣Йр╕нр╕бр╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╕зр╣Ир╕▓р╣Бр╕Хр╣Ир╕ер╕░р╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣Мр╣Гр╕Ф р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╣Бр╕ер╕░р╕Щр╕│р╣Др╕Ыр╣Гр╕Кр╣Йр╣Др╕Фр╣Йр╕Ир╕гр╕┤р╕З

### ЁЯФе р╕кр╣Бр╕Бр╕Щр╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Х + OS + Service + version
```bash
sudo nmap -sS -p- -sV -O -T4 -Pn <IP>
```
ЁЯУМ р╣Гр╕Кр╣Йр╣Ар╕бр╕╖р╣Ир╕нр╕Др╕╕р╕Ур╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕гр╕зр╕Ър╕гр╕зр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕Ър╕Ър╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Чр╕╡р╣Ир╕кр╕╕р╕Фр╣Гр╕Щр╕Др╕гр╕▒р╣Йр╕Зр╣Ар╕Фр╕╡р╕вр╕з: 
- `-p-` р╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- `-sV` р╕Хр╕гр╕зр╕Ир╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щ service
- `-O` р╣Ар╕Фр╕▓ OS
- `-T4` р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з
- `-Pn` р╣Др╕бр╣И ping р╕Бр╣Ир╕нр╕Щр╕кр╣Бр╕Бр╕Щ тЖТ р╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ъ target р╕Чр╕╡р╣И block ICMP

---

### ЁЯзк р╕Хр╕гр╕зр╕Ир╕лр╕▓ CVE (vuln scan)
```bash
nmap -sV --script vuln <IP>
```
ЁЯФО р╕Хр╕гр╕зр╕Ир╕лр╕▓р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щр╕Чр╕╡р╣Ир╕гр╕╣р╣Йр╕Ир╕▒р╕Б (CVE) р╕Ир╕▓р╕Б service version р╕Чр╕╡р╣Ир╣Ар╕Ыр╕┤р╕Фр╕нр╕вр╕╣р╣И р╣Вр╕Фр╕вр╣Гр╕Кр╣Йр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М `vuln` р╕Лр╕╢р╣Ир╕Зр╣Гр╕Кр╣Йр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕З Nmap р╣Ар╕нр╕Зр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ъ

---

### ЁЯФР р╕Хр╕гр╕зр╕И SSL Certificate
```bash
nmap --script ssl-cert -p 443 <IP>
```
ЁЯФР р╣Гр╕Кр╣Йр╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Гр╕Ър╕гр╕▒р╕Ър╕гр╕нр╕З SSL р╣Ар╕Кр╣Ир╕Щр╕зр╕▒р╕Щр╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕, issuer, CN р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щ тЖТ р╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕З HTTPS/web service

---

### ЁЯХ╕я╕П р╕Хр╕гр╕зр╕И directory hidden р╕Ър╕Щ web
```bash
nmap --script http-enum -p 80 <IP>
```
ЁЯз▒ р╕Др╣Йр╕Щр╕лр╕▓ directory р╕лр╕гр╕╖р╕н endpoint р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Лр╣Ир╕нр╕Щр╕нр╕вр╕╣р╣Ир╕Ър╕Щ web server р╣Ар╕Кр╣Ир╕Щ `/admin`, `/backup`, `/test` р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Йр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕н brute force р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯУВ р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З NSE Script р╣Ар╕Фр╣Ир╕Щ р╣Ж

| Script | р╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▓р╕гр╕Ц |
|--------|-------------|
| `http-enum` | р╕кр╕│р╕гр╕зр╕И directory/web page р╕Чр╕╡р╣Ир╕Лр╣Ир╕нр╕Щр╕нр╕вр╕╣р╣И |
| `ftp-anon` | р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓ FTP login р╣Бр╕Ър╕Ъ anonymous р╣Др╕Фр╣Йр╣Др╕лр╕б |
| `ssh-auth-methods` | р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓ SSH р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕г auth р╣Бр╕Ър╕Ър╣Гр╕Ф |
| `vuln` | р╕гр╕зр╕бр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕лр╕▓р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕▒р╣Ир╕зр╣Др╕Ы |
| `smb-os-discovery` | р╕Хр╕гр╕зр╕И OS р╕Ьр╣Ир╕▓р╕Щ SMB |
| `ssl-heartbleed` | р╕Хр╕гр╕зр╕Ир╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И Heartbleed |

р╕Др╣Йр╕Щр╕лр╕▓ script р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б:
```bash
ls /usr/share/nmap/scripts/
```

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯз░ р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

- р╣Гр╕Кр╣Й `-oN` р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕ер╕Зр╣Др╕Яр╕ер╣М:
```bash
nmap -sV -oN result.txt <IP>
```

- р╕Др╣Йр╕Щр╕лр╕▓ host р╕Чр╕▒р╣Йр╕З subnet:
```bash
nmap -sn 192.168.1.0/24
```

- р╣Гр╕Кр╣Йр╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Ъ wordlist (р╕Ир╕│р╕Бр╕▒р╕Фр╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕▓р╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в):
```bash
nmap -iL target_list.txt -sV
```

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯза р╣Гр╕Кр╣Йр╣Гр╕Щ CTF р╕лр╕гр╕╖р╕н OSCP р╕вр╕▒р╕Зр╣Др╕З

1. р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Б `nmap -sS -p- -T4 -Pn <IP>` тЖТ р╕Фр╕╣р╕зр╣Ир╕▓р╕нр╕░р╣Др╕гр╣Ар╕Ыр╕┤р╕Ф
2. р╕Хр╣Ир╕нр╕Фр╣Йр╕зр╕в `-sV -sC` тЖТ р╕Фр╕╣ service р╣Бр╕ер╕░ run script р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
3. р╕Цр╣Йр╕▓р╣Ар╕Ыр╣Зр╕Щр╣Ар╕зр╣Зр╕Ъ тЖТ р╣Гр╕Кр╣Й `http-enum`, `http-title`, `http-methods`
4. р╕лр╕▓ CVE тЖТ р╣Гр╕Кр╣Й `--script vuln`, р╕лр╕гр╕╖р╕н export service р╣Др╕Ыр╕лр╕▓ PoC р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Зр╕ер╕│р╕Фр╕▒р╕Ъ Option р╕Вр╕нр╕З Nmap

> р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕З Option р╣Гр╕Щр╕Др╕│р╕кр╕▒р╣Ир╕З Nmap р╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕нр╕Зр╣Ар╕гр╕╡р╕вр╕Зр╣Ар╕Ыр╣Кр╕░р╣Ар╕кр╕бр╕нр╣Др╕Ыр╣Ар╕Юр╕гр╕▓р╕░ `nmap` р╕Ир╕░р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Хр╕▓р╕бр╕Кр╕Щр╕┤р╕Фр╕Вр╕нр╕З flag  
> р╣Бр╕Хр╣Ир╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Зр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╣Ар╕Ър╕╡р╕вр╕Ър╕Ир╕░р╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Й **р╕нр╣Ир╕▓р╕Щр╕Зр╣Ир╕▓р╕в**, **р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕гр╣Зр╕з**, р╣Бр╕ер╕░ **р╕ер╕Фр╣Вр╕нр╕Бр╕▓р╕кр╕Юр╕ер╕▓р╕Ф**

## тЬЕ р╕ер╕│р╕Фр╕▒р╕Ър╕Чр╕╡р╣Ир╕бр╕╖р╕нр╣Вр╕Ыр╕гр╕Щр╕┤р╕вр╕бр╣Гр╕Кр╣Й

```bash
nmap [Scan Type] [Port Selection] [Timing] [Ping Option] [Version/OS Detect] [Evasion] [Script] [Output] <target>
```

### р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:
```bash
sudo nmap -sS -p- -T4 -Pn -sV -O -D RND:10 --source-port 53 -f --mtu 16 --script vuln -oA result <target>
```

---

## ЁЯФв р╕ер╕│р╕Фр╕▒р╕Ър╕Чр╕╡р╣Ир╣Бр╕Щр╕░р╕Щр╕│

| р╕ер╕│р╕Фр╕▒р╕Ъ | р╕лр╕бр╕зр╕Ф | р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З | р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ |
|-------|------|----------|----------|
| 1 | Scan Type | `-sS`, `-sU`, `-sT` | р╕зр╕┤р╕Шр╕╡р╕кр╣Бр╕Бр╕Щ |
| 2 | Port | `-p-`, `-F` | р╕гр╕░р╕Ър╕╕р╕Юр╕нр╕гр╣Мр╕Х |
| 3 | Timing | `-T0` р╕Цр╕╢р╕З `-T5` | р╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕зр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ |
| 4 | Ping | `-Pn`, `-sn` | р╕Хр╕гр╕зр╕Ир╕зр╣Ир╕▓ host up |
| 5 | Service/OS Detect | `-sV`, `-O`, `--version-intensity` | р╕Хр╕гр╕зр╕Ир╕лр╕▓ service version р╕лр╕гр╕╖р╕н OS |
| 6 | Evasion | `-D`, `--spoof-mac`, `--source-port`, `--mtu`, `-f` | р╕Ыр╕ер╕нр╕бр╣Бр╕Ыр╕ер╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕Ър╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ъ |
| 7 | NSE Script | `--script vuln`, `--script http-enum` | р╣Гр╕Кр╣Йр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Хр╕гр╕зр╕Ир╣Ар╕Ир╕▓р╕░р╣Ар╕Йр╕Юр╕▓р╕░ |
| 8 | Output | `-oN`, `-oX`, `-oA` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М |

---

## ЁЯОп р╣Ар╕лр╕Хр╕╕р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕зр╕гр╣Ар╕гр╕╡р╕вр╕З

- р╕нр╣Ир╕▓р╕Щр╕Зр╣Ир╕▓р╕в: р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕гр╣Зр╕зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Др╕ер╣Ир╕лр╕▓ option
- р╣Бр╕Бр╣Йр╣Др╕Вр╕кр╕░р╕Фр╕зр╕Б: р╕нр╕вр╕▓р╕Бр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕нр╕░р╣Др╕гр╕гр╕╣р╣Йр╕зр╣Ир╕▓р╕Хр╕гр╕Зр╣Др╕лр╕Щ
- р╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╣Др╕Фр╣Йр╕Фр╕╡: р╣Ар╕зр╕ер╕▓р╣Бр╕Кр╕гр╣Мр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕лр╣Йр╕Др╕Щр╕нр╕╖р╣Ир╕Щр╕нр╣Ир╕▓р╕Щ

## ЁЯза р╕кр╕гр╕╕р╕Ыр╣Бр╕Ър╕Ър╕Ир╕│
> **Scan тЖТ Port тЖТ Timing тЖТ Ping тЖТ Detect тЖТ Evasion тЖТ Script тЖТ Output**

р╕ер╕нр╕Зр╕вр╕╢р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Щр╕╡р╣Йр╣Др╕зр╣Й р╣Бр╕ер╣Йр╕зр╕Хр╣Ир╕нр╣Др╕Ыр╕Др╕╕р╕Ур╕Ир╕░р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й Nmap р╣Бр╕Ър╕Ър╣Вр╕Ыр╕гр╣Др╕Фр╣Йр╕Др╕ер╣Ир╕нр╕Зр╕Бр╕зр╣Ир╕▓р╣Ар╕Фр╕┤р╕б ЁЯЪА

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯУЪ р╕зр╕┤р╕Шр╕╡р╕ир╕╢р╕Бр╕йр╕▓р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

р╕лр╕▓р╕Бр╕Др╕╕р╕Ур╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╕Эр╕Щр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╣Гр╕Кр╣Й Nmap р╕нр╕вр╣Ир╕▓р╕Зр╕бр╕╡р╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Ю р╣Бр╕Щр╕░р╕Щр╕│р╣Бр╕лр╕ер╣Ир╕Зр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╕Фр╕▒р╕Зр╕Хр╣Ир╕нр╣Др╕Ыр╕Щр╕╡р╣Й:

- ЁЯМР [Nmap Official Book](https://nmap.org/book/) тАФ р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Ыр╣Зр╕Щр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╣Вр╕Фр╕вр╕Ьр╕╣р╣Йр╕Юр╕▒р╕Тр╕Щр╕▓
- ЁЯУШ [Nmap Reference Guide](https://nmap.org/man/) тАФ man page р╕нр╕вр╣Ир╕▓р╕Зр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╕Юр╕▒р╕Тр╕Щр╕▓
- ЁЯТб [TryHackMe: Nmap Room](https://tryhackme.com/room/nmap) тАФ р╕лр╣Йр╕нр╕Зр╣Ар╕гр╕╡р╕вр╕Щр╕нр╕нр╕Щр╣Др╕ер╕Щр╣Мр╕Юр╕гр╣Йр╕нр╕б lab р╣Гр╕лр╣Йр╕ер╕нр╕Зр╕Ир╕гр╕┤р╕З
- ЁЯТб [Hack The Box: Starting Point - Nmap](https://www.hackthebox.com/) тАФ р╕ар╕▓р╕гр╕Бр╕┤р╕Ир╣Бр╕Щр╕░р╕Щр╕│р╕кр╕│р╕лр╕гр╕▒р╕Ър╕бр╕╖р╕нр╣Гр╕лр╕бр╣И
  
### ЁЯУЦ р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Гр╕Щр╕Др╕│р╕кр╕▒р╣Ир╕З

### ЁЯФН р╣Гр╕Кр╣Й man page р╣Бр╕ер╕░ help command

Nmap р╕бр╕╡р╣Ар╕нр╕Бр╕кр╕▓р╕гр╣Гр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╣Др╕Фр╣Йр╣Вр╕Фр╕вр╕Хр╕гр╕З:

```bash
man nmap
```
р╕Ир╕░р╣Ар╕Ыр╕┤р╕Фр╕лр╕Щр╣Йр╕▓ manual р╕Чр╕╡р╣Ир╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Чр╕╡р╣Ир╕кр╕╕р╕Ф р╕Др╕гр╕нр╕Ър╕Др╕ер╕╕р╕бр╕Чр╕╕р╕Б option р╕Юр╕гр╣Йр╕нр╕бр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З

```bash
nmap --help
```
р╣Бр╕кр╕Фр╕Зр╕кр╕гр╕╕р╕Ыр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Ър╣Ир╕нр╕в р╕гр╕зр╕бр╕Цр╕╢р╕Зр╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Бр╕лр╕ер╕▒р╕Б р╣Ж

### ЁЯТб Tip:
- р╣Гр╕Кр╣Й `man` р╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Ъ `/` р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╣Йр╕Щр╕лр╕▓р╕Др╕│р╕ар╕▓р╕вр╣Гр╕Щр╕лр╕Щр╣Йр╕▓ р╣Ар╕Кр╣Ир╕Щ `/spoof` р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓ spoofing
- р╣Гр╕Кр╣Й `q` р╣Ар╕Юр╕╖р╣Ир╕нр╕нр╕нр╕Бр╕Ир╕▓р╕Б man page
- р╣Гр╕Кр╣Й `h` р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣ help р╕ар╕▓р╕вр╣Гр╕Щ `man`
- 
<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

---

## ЁЯЫбя╕П р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕нр╕вр╣Ир╕▓р╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Ир╕гр╕┤р╕Зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Ар╕Фр╣Зр╕Фр╕Вр╕▓р╕Ф
- р╕Бр╕▓р╕гр╣Гр╕Кр╣Й script р╕нр╕▓р╕Ир╕Бр╕гр╕░р╕Чр╕Ър╕гр╕░р╕Ър╕Ър╕Ир╕гр╕┤р╕З
- р╕Др╕зр╕гр╣Гр╕Кр╣Йр╣Гр╕Щ lab, CTF р╕лр╕гр╕╖р╕нр╕гр╕░р╕Ър╕Ър╕Чр╕╡р╣Ир╕Др╕╕р╕Ур╕Др╕зр╕Ър╕Др╕╕р╕бр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ

> ЁЯТг Nmap р╣Др╕бр╣Ир╣Гр╕Кр╣Ир╣Бр╕Др╣И scanner тАФ р╕бр╕▒р╕Щр╕Др╕╖р╕нр╣Ар╕гр╕Фр╕▓р╕гр╣Мр╕Вр╕нр╕Зр╕Щр╕▒р╕Бр╣Ар╕Ир╕▓р╕░р╕гр╕░р╕Ър╕Ър╕Чр╕╕р╕Бр╕Др╕Щ  
> р╣Гр╕Кр╣Йр╕Др╕ер╣Ир╕нр╕З = р╣Ар╕лр╣Зр╕Щр╕Чр╕╕р╕Бр╕Чр╕▓р╕Зр╣Ар╕Вр╣Йр╕▓ р╣Гр╕Кр╣Йр╣Др╕бр╣Ир╕Др╕ер╣Ир╕нр╕З = р╣Ар╕Фр╕┤р╕Щр╣Ар╕Вр╣Йр╕▓р╕Бр╕▒р╕Ър╕Фр╕▒р╕Б ЁЯХ╡я╕П

<sub>[тмЖ Home](#-р╕кр╕▓р╕гр╕Ър╕▒р╕Н)</sub>

