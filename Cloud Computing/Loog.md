# üß± A Generic Logging Template for IaaS Cloud

> ‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢: *"A Generic Logging Template for Infrastructure as a Service Cloud"*  
> ‡πÇ‡∏î‡∏¢ Winai Wongthai, Francisco Liberal Rocha, Aad van Moorsel (Newcastle University)

---

## üìë ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [üìå ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Logging Template](#-‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°-logging-template)
- [üñºÔ∏è ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS (Figure 1)](#-‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°-iaas-figure-1)
- [üß© ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á Template (Figure 2)](#-‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á-template-figure-2)
  - [üì¶ ‡∏ä‡∏∏‡∏î IaaS Components](#-‡∏ä‡∏∏‡∏î-iaas-components)
  - [‚öôÔ∏è Logging Processes (Px)](#Ô∏è-logging-processes-px)
  - [üóÉÔ∏è Log Files (Fy)](#Ô∏è-log-files-fy)
- [üóÇÔ∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Critical Files ‡πÅ‡∏•‡∏∞ Threat 1](#-‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á-critical-files-‡πÅ‡∏•‡∏∞-threat-1)
  - [üìÅ Customers‚Äô Critical Files in domUs](#-customers-critical-files-in-domus)
  - [üö® Threat 1: Abuse of Cloud to Attack](#-threat-1-abuse-of-cloud-to-attack)
- [üìà ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ Logging ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Threat 1](#-‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ-logging-‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£-threat-1)
  - [üìÅ A. History of Critical Files](#-a-history-of-critical-files-file-centric-log)
  - [‚öôÔ∏è B. Process Behaviour Log](#-b-process-behaviour-log)
- [‚úâÔ∏è Case Study: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Spam ‡∏î‡πâ‡∏ß‡∏¢ Behaviour Log](#-case-study-‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á-spam-‡∏î‡πâ‡∏ß‡∏¢-behaviour-log)
- [üèóÔ∏è System Architecture ‡∏Ç‡∏≠‡∏á Logging Solution](#-system-architecture-‡∏Ç‡∏≠‡∏á-logging-solution)
- [üîí ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢](#-‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
- [‚úÖ ‡∏™‡∏£‡∏∏‡∏õ](#-‡∏™‡∏£‡∏∏‡∏õ)
- [üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á](#-‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)

---

## üìå ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Logging Template

Template ‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Logging ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö IaaS ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏î‡∏¢ CSA (Cloud Security Alliance)

‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏´‡∏•‡∏±‡∏Å:
- ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å 7 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á CSA
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Logging ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î Accountability ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á (Auditability)

---

## üñºÔ∏è ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS (Figure 1)

> IaaS ‡πÅ‡∏ö‡∏ö Xen-based ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ dom0, domU, hypervisor ‡πÅ‡∏•‡∏∞ hardware

![Figure 1 - IaaS Architecture](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure1.png)

- `dom0` ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏π‡∏á ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏•‡∏ö domU  
- `domU` ‡πÄ‡∏õ‡πá‡∏ô VM ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô  
- `hypervisor` ‡πÄ‡∏õ‡πá‡∏ô‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ VM  
- `hw` ‡∏Ñ‡∏∑‡∏≠ physical server ‡∏à‡∏£‡∏¥‡∏á

---

## üß© ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á Template (Figure 2)

‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á Logging Process (Px) ‡πÅ‡∏•‡∏∞ Log File (Fy) ‡∏ö‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á IaaS  
‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Logging ‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á

![Figure 2 - Logging Template](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure2.png)

---

### üì¶ ‡∏ä‡∏∏‡∏î IaaS Components

| Component | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô IaaS |
|----------|------------|----------------|
| `hw0`    | ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö | Provider |
| `disk0`  | Physical Disk ‡∏Ç‡∏≠‡∏á hw0 | hw0 |
| `mem0`   | Main Memory ‡∏Ç‡∏≠‡∏á hw0 | hw0 |
| `hypervisor` | ‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ VM | ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á hw0 ‚Üî dom0 |
| `dom0`   | ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Root | Provider |
| `app0`   | Logging App ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô‡πÉ‡∏ô dom0 | dom0 |
| `domU`   | Guest OS ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô | User |
| `appU`   | ‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô domU | User |
| `hwU`    | ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á domU | Virtual Layer |
| `diskU`  | Virtual Disk ‡πÉ‡∏ô domU | ‡∏ö‡∏ô disk0 ‡∏à‡∏£‡∏¥‡∏á |
| `memU`   | Virtual Memory ‡πÉ‡∏ô domU | ‡∏ö‡∏ô mem0 ‡∏à‡∏£‡∏¥‡∏á |

---

### ‚öôÔ∏è Logging Processes (Px)

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà |
|----|----------|----------|
| `P1` | dom0 user | ‡∏≠‡πà‡∏≤‡∏ô memU ‡∏ú‡πà‡∏≤‡∏ô libVMI |
| `P2` | dom0 kernel | ‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö network/file ops |
| `P3` | domU kernel | ‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö system call ‡∏Ç‡∏≠‡∏á domU |
| `P4` | hypervisor | ‡∏î‡∏±‡∏Å network packet ‡∏Ç‡∏≠‡∏á domU |

---

### üóÉÔ∏è Log Files (Fy)

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á | ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• |
|----|----------|--------------|
| `F1` | diskU | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß |
| `F2` | memU | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß |
| `F3` | disk0 | log ‡∏ñ‡∏≤‡∏ß‡∏£ |
| `F4` | mem0 | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß |

---

## üóÇÔ∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Critical Files ‡πÅ‡∏•‡∏∞ Threat 1

### üìÅ Customers‚Äô Critical Files in domUs

- ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÑ‡∏ß‡πâ‡πÉ‡∏ô `diskU` ‡πÄ‡∏ä‡πà‡∏ô:
  - source code, database, binary, ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
- ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á

![Figure 3 - Critical File in diskU](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure3.png)

---

### üö® Threat 1: Abuse of Cloud to Attack

#### A. ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

| ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|----------|-------------|
| domU ‚Üí domU | VM ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡πÅ‡∏≠‡∏ö‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏à‡∏°‡∏ï‡∏µ VM ‡∏≠‡∏∑‡πà‡∏ô |
| domU ‚Üí dom0 | ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà hypervisor ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≤‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤ dom0 |
| dom0 ‚Üí domU | ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠ attacker ‡πÅ‡∏≠‡∏ö‡∏≠‡πà‡∏≤‡∏ô memory / log ‡πÉ‡∏ô domU |

#### B. ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£

| ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|----------|-------------|
| domU ‚Üí dom0 | ‡∏´‡∏≤‡∏Å domU ‡πÄ‡∏à‡∏≤‡∏∞ hypervisor ‡πÑ‡∏î‡πâ ‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° dom0 |
| ‡∏Ç‡πâ‡∏≤‡∏° host | ‡∏Ç‡πâ‡∏≤‡∏° physical boundary ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á host ‡πÑ‡∏î‡πâ |

---

## üìà ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ Logging ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Threat 1

### üìÅ A. History of Critical Files (File-centric Log)

‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏Ñ‡∏∑‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå" ‡πÇ‡∏î‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà:
- ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á (`p_id`)
- ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (`p_nm`)
- ‡πÄ‡∏ß‡∏•‡∏≤ (`created`, `read`, `write`, `delete`)

üìä **Table 1: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Log ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÑ‡∏ü‡∏•‡πå `.s.txt`**

| ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå | p_id | p_nm  | p_ownid |
|----------|------|-------|---------|
| s.txt    | 6424 | cat   | 1002 (Bob) |

---

### ‚öôÔ∏è B. Process Behaviour Log

‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á process ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ command ‡∏≠‡∏∞‡πÑ‡∏£, ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏´‡∏ô, ‡∏°‡∏µ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏∞‡πÑ‡∏£

üìä **Table 2: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Log ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° Process**

| p_nm | cat | file | addr.txt | p_ownid |
|------|-----|------|----------|---------|
| cat  | 2400| addr.txt | 1002 (Bob) |

---

## ‚úâÔ∏è Case Study: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Spam ‡∏î‡πâ‡∏ß‡∏¢ Behaviour Log

```bash
mail -s "spam a@b.c" addr.txt
```

- ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏• spam ‡πÑ‡∏õ‡∏¢‡∏±‡∏á address ‡πÉ‡∏ô `addr.txt`
- ‡πÉ‡∏ä‡πâ log ‡∏Ç‡∏≠‡∏á `cat`, `mail`, ‡πÅ‡∏•‡∏∞ `addr.txt` ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö

---

## üèóÔ∏è System Architecture ‡∏Ç‡∏≠‡∏á Logging Solution

‡πÉ‡∏ä‡πâ libVMI ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å memU ‡∏Ç‡∏≠‡∏á domU ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å log ‡∏•‡∏á disk0

![Figure 5 - System Architecture](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure5.png)

---

## üîí ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

- domU **‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç** logger ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô dom0 ‡πÑ‡∏î‡πâ
- ‡πÉ‡∏ä‡πâ `libVMI` ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î TCB (Trusted Computing Base)
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• log ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `disk0` ‡∏ã‡∏∂‡πà‡∏á‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏î‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ

Template ‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤ Logging System ‡∏ó‡∏µ‡πà:
- ‡∏•‡∏î Trusted Computing Base
- ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ó‡∏±‡πâ‡∏á File-centric ‡πÅ‡∏•‡∏∞ Process-centric log
- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÄ‡∏ä‡πà‡∏ô spam, data exfiltration
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

---

---

## üì• ‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å memU ‡∏î‡πâ‡∏ß‡∏¢ libVMI

‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á `logger` (‡∏£‡∏±‡∏ô‡πÉ‡∏ô dom0) ‡∏à‡∏∞‡πÉ‡∏ä‡πâ `libVMI` ‡∏≠‡πà‡∏≤‡∏ô memory ‡∏Ç‡∏≠‡∏á domU ‡πÄ‡∏û‡∏∑‡πà‡∏≠:

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ process ‡πÉ‡∏î‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∞‡πÑ‡∏£
- ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (string), ‡∏ä‡∏∑‡πà‡∏≠ process, PID, UID ‡∏Ø‡∏•‡∏Ø

üñºÔ∏è **Figure 6:** ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á logger ‡∏£‡∏±‡∏ô‡πÉ‡∏ô dom0 ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:

```bash
$ ./logger
s.txt, by_proc_id: 4624, by_proc_name: read, by_proc_owner_id: 1002
```

üñºÔ∏è **Figure 7:** ‡πÅ‡∏™‡∏î‡∏á read command ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡πà‡∏≤‡∏ô s.txt

```bash
$ ./read
...start reading... s.txt
```

---

## üß† ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å kernel structure (VMI)

libVMI ‡∏à‡∏∞‡∏ï‡∏≤‡∏° pointer chain ‡πÉ‡∏ô kernel ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

1. `task_struct` ‚Üí `files`
2. `files` ‚Üí `fdt` ‚Üí `fd` ‚Üí `file`
3. `file` ‚Üí `f_path` ‚Üí `dentry` ‚Üí `d_name` ‚Üí `*name`

üñºÔ∏è **Figure 8 ‚Äì 9:** ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á kernel ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå `s.txt`

- Figure 8: ‡∏ä‡∏µ‡πâ pointer chain ‡∏Ç‡∏≠‡∏á file descriptor
- Figure 9: ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á dentry ‚Üí string `s.txt`

---

## üß™ ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥

‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ Alice ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç `s.txt`  
‚Üí ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á log ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏ö‡πâ‡∏≤‡∏á

üìä **Table III: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÑ‡∏ü‡∏•‡πå `s.txt`**

| Time  | p_nm   | p_id | file  | p_ownid | Note |
|-------|--------|------|-------|---------|------|
| t_01  | read   | 4624 | s.txt | 1002    | ‚úîÔ∏è   |
| t_02  | read   | 4624 | s.txt | 1002    | ‚úîÔ∏è   |
| t_03  | cat    | 7000 | s.txt | 1002    | ‚ùå   |
| t_04  | read   | 4624 | s.txt | 1002    | ‚úîÔ∏è   |
| t_05  | mail   | 9999 | s.txt | 1002    | ‚ùå   |

üîç ‡∏à‡∏∏‡∏î‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥:
- `t_03`: ‡πÉ‡∏ä‡πâ `cat` ‡πÅ‡∏ó‡∏ô `read` ‚Üí ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
- `t_05`: ‡πÉ‡∏ä‡πâ `mail` ‡∏≠‡πà‡∏≤‡∏ô `s.txt` ‚Üí ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á spam

üìå ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà:
- ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö **attack behavior**
- ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö (accountability)**
- ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠ auditor

---


