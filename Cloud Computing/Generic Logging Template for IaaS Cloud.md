# üì¶ A Generic Logging Template for IaaS Cloud

> **‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô:** Winai Wongthai, Francisco Liberal Rocha, Aad van Moorsel  
> **‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:** School of Computing Science, Newcastle University  
> **‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå:** 2013  
> **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:** ‡πÄ‡∏™‡∏ô‡∏≠ template ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Logging System ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö IaaS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° Cloud

---

## üìö ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [1. ‡∏ö‡∏ó‡∏ô‡∏≥](#1-‡∏ö‡∏ó‡∏ô‡∏≥)
- [2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS](#2-‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°-iaas)
- [3. ‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° CSA ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ç‡πâ‡∏≠](#3-‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°-csa-‡∏ó‡∏±‡πâ‡∏á-7-‡∏Ç‡πâ‡∏≠)
- [4. Logging System Template](#4-logging-system-template)
- [5. ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Px ‡πÅ‡∏•‡∏∞ Fy](#5-‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö-px-‡πÅ‡∏•‡∏∞-fy)
- [6. ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Spam Mail](#6-‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤-‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö-spam-mail)
- [7. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢](#7-‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
- [8. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå](#8-‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå)

---

## 1. ‡∏ö‡∏ó‡∏ô‡∏≥

Logging system ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô IaaS cloud ‡πÄ‡∏û‡∏∑‡πà‡∏≠:
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
- ‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
- ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°

Logging System = Logging Processes (Px) + Log Files (Fy)

---

## 2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS

‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 2 ‡∏ù‡∏±‡πà‡∏á‡∏´‡∏•‡∏±‡∏Å:

- **Provider Side**: hw ‚Üí hypervisor ‚Üí dom0 ‚Üí domUs  
- **Customer Side**: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πà‡∏≤ domU ‡∏ú‡πà‡∏≤‡∏ô Internet

üñºÔ∏è *Figure 1: The IaaS architecture*

![Figure 1](94fc84ba-2463-46d6-935e-649fa44071a5.png)

---

## 3. ‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° CSA ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ç‡πâ‡∏≠

1. Abuse of Cloud Resources (‡πÄ‡∏ä‡πà‡∏ô spam, botnet)
2. Insecure APIs
3. Malicious Insiders
4. Shared Technology Issues
5. Data Loss / Leakage
6. Account Hijacking
7. Unknown Risk Profile

---

## 4. Logging System Template

Template ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ß‡∏≤‡∏á Logging Process (Px) ‡πÅ‡∏•‡∏∞ Log File (Fy)  
‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô domU, dom0, hypervisor

üñºÔ∏è *Figure 2: Logging System Template*

![Figure 2](1fcdfacd-03ed-41a6-9cd0-acc93e4a4fe2.png)

---

## 5. ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Px ‡πÅ‡∏•‡∏∞ Fy

### Px ‚Äì Logging Process

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å |
|----|------------------|----------|--------------|
| P1 | dom0 user level | libVMI | ‡∏≠‡πà‡∏≤‡∏ô memory ‡∏Ç‡∏≠‡∏á VM |
| P2 | dom0 kernel | Flogger | ‡∏î‡∏±‡∏Å syscall, file, network |
| P3 | domU kernel | Flogger | ‡∏î‡∏±‡∏Å syscall ‡πÉ‡∏ô VM |
| P4 | hypervisor | Logger | ‡∏î‡∏±‡∏Å network ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á domUs |

### Fy ‚Äì Log File

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|----|------------------|--------|---------|
| F1 | diskU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏à‡∏≤‡∏Å domU |
| F2 | memU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡πÉ‡∏ô memory domU |
| F3 | disk0 | ‡∏ñ‡∏≤‡∏ß‡∏£ | log ‡∏ñ‡∏≤‡∏ß‡∏£‡πÉ‡∏ô provider |
| F4 | mem0 | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÉ‡∏ô dom0 |

---

## 6. ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Spam Mail

### üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:
‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á spam mail ‡∏à‡∏≤‡∏Å domU ‚Üí ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô

### üì• ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢:
```bash
mail -s spamSubject winai.wongthai@ncl.ac.uk
```
‚Üí ag1 = `-s`, ag2 = `spamSubject`, ag3 = `winai.wongthai@ncl.ac.uk`

### üîß ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£:
- ‡πÉ‡∏ä‡πâ `libVMI` (P1) ‡πÉ‡∏ô dom0 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡πà‡∏≤‡∏ô memU
- ‡∏™‡∏Å‡∏±‡∏î‡∏Ñ‡πà‡∏≤ ag2, ag3
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (F3)

üñºÔ∏è *Figure 4: Logging system ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö spam (CSA Threat #1)*

![Figure 4](1cdc66ee-34ee-4958-83a5-ced47a94d645.png)

---

### üß™ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
‡πÄ‡∏°‡∏∑‡πà‡∏≠ domU ‡∏™‡πà‡∏á mail ‚Üí LA (Logging App) ‡πÉ‡∏ô dom0 ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å memory  
‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å subject + email address ‡πÄ‡∏õ‡πá‡∏ô log

üñºÔ∏è *Figure 6: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á output ‡∏à‡∏≤‡∏Å Logging App*

![Figure 6](c6677e1a-644f-4553-bc6d-8a417ac00397.png)

---

## 7. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

- log (F3) ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏µ‡πà disk0 ‚Üí ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏à‡∏≠‡πà‡∏≤‡∏ô/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç log
- ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô encryption, access control

---

## 8. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå

‚úÖ Template ‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ:
- ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö logging system ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö threat ‡∏Ç‡∏≠‡∏á CSA ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö

> ‚öôÔ∏è ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö cloud accountability ‡πÅ‡∏•‡∏∞ forensic investigation

