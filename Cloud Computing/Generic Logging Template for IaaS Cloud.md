
# üì¶ A Generic Logging Template for IaaS Cloud

> **‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô:** Winai Wongthai, Francisco Liberal Rocha, Aad van Moorsel  
> **‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:** School of Computing Science, Newcastle University  
> **‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå:** 2013  
> **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:** ‡πÄ‡∏™‡∏ô‡∏≠ template ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Logging System ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö IaaS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° Cloud

---

## üìö ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [1. ‡∏ö‡∏ó‡∏ô‡∏≥](#1-‡∏ö‡∏ó‡∏ô‡∏≥)
- [2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS](#2-‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°-iaas)
- [3. ‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° CSA ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ç‡πâ‡∏≠](#3-‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°-csa-‡∏ó‡∏±‡πâ‡∏á-7-‡∏Ç‡πâ‡∏≠-‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°)
- [4. Logging System Template](#4-logging-system-template)
  - [üîç ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à: libVMI ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?](#-‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à-libvmi-‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£)
- [5. ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Px ‡πÅ‡∏•‡∏∞ Fy](#5-‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö-px-‡πÅ‡∏•‡∏∞-fy)
- [6. ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Spam Mail](#6-‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤-‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö-spam-mail)
  - [üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á Logging ‡∏Å‡∏£‡∏ì‡∏µ spam](#-‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á-logging-‡∏Å‡∏£‡∏ì‡∏µ-spam)
  - [üîÅ ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô](#-‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)
  - [üîç ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Logging System ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á spam (‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)](#-‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á-logging-system-‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á-spam-‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)
- [7. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢](#7-‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
- [8. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå](#8-‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå)
- [üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á](#üîó-‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)


---

## 1. ‡∏ö‡∏ó‡∏ô‡∏≥

Logging system ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô IaaS cloud ‡πÄ‡∏û‡∏∑‡πà‡∏≠:
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
- ‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
- ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°

Logging System = Logging Processes (Px) + Log Files (Fy)

---

## 2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS

‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 2 ‡∏ù‡∏±‡πà‡∏á‡∏´‡∏•‡∏±‡∏Å:

- **Provider Side**: hw ‚Üí hypervisor ‚Üí dom0 ‚Üí domUs  
- **Customer Side**: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πà‡∏≤ domU ‡∏ú‡πà‡∏≤‡∏ô Internet

![Figure 1](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure1.png)

üñºÔ∏è *Figure 1: The IaaS architecture*  

---

## 3. ‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° CSA ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ç‡πâ‡∏≠ (‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°)

| # | ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° | ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô IaaS |
|--:|----------------|-----------------|------------------|
| 1 | **Abuse and Nefarious Use of Cloud Services** | ‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏±‡∏á‡∏î‡∏µ‡πÉ‡∏ä‡πâ VM ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πà‡∏≤‡∏°‡∏≤‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ | ‡∏™‡∏£‡πâ‡∏≤‡∏á botnet, ‡∏™‡πà‡∏á spam mail, ‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï |
| 2 | **Insecure Interfaces and APIs** | ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏Ç‡∏≠‡∏á API ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏ú‡πà‡∏≤‡∏ô API ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ auth (unauthenticated REST endpoint) |
| 3 | **Malicious Insiders** | ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ cloud ‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏¥‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå | Admin ‡∏Ç‡∏≠‡∏á dom0 ‡∏î‡∏π log ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• |
| 4 | **Shared Technology Issues** | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏¢‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | side-channel attack ‡πÄ‡∏ä‡πà‡∏ô Meltdown, Spectre |
| 5 | **Data Loss or Leakage** | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏Ç‡πÇ‡∏°‡∏¢‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö cloud | VM crash ‡πÅ‡∏•‡πâ‡∏ß data ‡∏ö‡∏ô disk ‡∏´‡∏≤‡∏¢, ‡∏Å‡∏≤‡∏£ config S3 ‡∏ú‡∏¥‡∏î |
| 6 | **Account or Service Hijacking** | ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡πÅ‡∏Æ‡πá‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πÇ‡∏°‡∏¢ token access | ‡∏Ç‡πÇ‡∏°‡∏¢ SSH key ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á VM ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß |
| 7 | **Unknown Risk Profile** | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ provider ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô | ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ log ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? ‡πÉ‡∏Ñ‡∏£‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡∏π? ‡∏´‡∏£‡∏∑‡∏≠ VM ‡πÅ‡∏ä‡∏£‡πå‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£?

---

## 4. Logging System Template

Template ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ß‡∏≤‡∏á Logging Process (Px) ‡πÅ‡∏•‡∏∞ Log File (Fy)  
‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô domU, dom0, hypervisor

![Figure 2](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure2.png)

üñºÔ∏è *Figure 2: Logging System Template*  

### üß© ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ï‡πà‡∏≤‡∏á

| Component | Description/Functions | Examples | Locations in IaaS environment |
|-----------|------------------------|----------|-------------------------------|
| **hw0**   | Physical hardware ‡πÇ‡∏î‡∏¢ provider | a PC/server | in the provider side infrastructure |
| **disk0** | Physical disk ‡∏Ç‡∏≠‡∏á hw0 (‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢ dom0) | server‚Äôs disks | physically in hw0 |
| **mem0**  | Main memory ‡∏Ç‡∏≠‡∏á hw0 | server‚Äôs main memory | physically in hw0 |
| **hypervisor** | ‡∏£‡∏±‡∏ô dom0 ‡πÅ‡∏•‡∏∞ domU | Xen | on top of hw0 |
| **dom0** | ‡∏£‡∏±‡∏ô‡πÇ‡∏î‡∏¢ provider (‡∏°‡∏µ app0) | Fedora 16 dom0 | on top of the hypervisor |
| **app0** | ‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á dom0 | logging-related application | in dom0 user level |
| **domU** | VM ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏°‡∏µ appU, hwU) | Fedora 16 domU | on top of the hypervisor |
| **appU** | ‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á user ‡πÉ‡∏ô domU | mail command | in domU user level |
| **hwU** | virtual hardware ‡∏Ç‡∏≠‡∏á domU | - | virtually in domU |
| **diskU** | virtual disk ‡∏Ç‡∏≠‡∏á domU | - | virtually in hwU |
| **memU** | virtual memory ‡∏Ç‡∏≠‡∏á domU | - | virtually in hwU |

---

## üîç ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à: libVMI ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

**libVMI** (Virtual Machine Introspection Library) ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ open-source ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô memory ‡∏Ç‡∏≠‡∏á VM **‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô VM ‡∏ô‡∏±‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á**

### ‚úÖ ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á libVMI
- ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å **dom0 ‡∏´‡∏£‡∏∑‡∏≠ hypervisor layer**
- **‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô process, memory ‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô VM ‡πÑ‡∏î‡πâ‡πÅ‡∏ö‡∏ö stealthy**
- ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô **forensics, malware analysis, ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢**

### üß† ‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ?
‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Logging Template:
- **P1 (Logging Process)** ‡πÉ‡∏ä‡πâ libVMI ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å memU (memory ‡∏Ç‡∏≠‡∏á domU)
- ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô `mail -s spamSubject ...` ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô memory
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á logging agent ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô domU ‚Üí ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏ö‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á

> ‚ö†Ô∏è ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô libVMI ‡πÉ‡∏ô production ‡∏à‡∏£‡∏¥‡∏á‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô performance ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

---

## 5. ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Px ‡πÅ‡∏•‡∏∞ Fy

### Px ‚Äì Logging Process

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å |
|----|------------------|----------|--------------|
| P1 | dom0 user level | libVMI | ‡∏≠‡πà‡∏≤‡∏ô memory ‡∏Ç‡∏≠‡∏á VM |
| P2 | dom0 kernel | Flogger | ‡∏î‡∏±‡∏Å syscall, file, network |
| P3 | domU kernel | Flogger | ‡∏î‡∏±‡∏Å syscall ‡πÉ‡∏ô VM |
| P4 | hypervisor | Logger | ‡∏î‡∏±‡∏Å network ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á domUs |

### Fy ‚Äì Log File

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|----|------------------|--------|---------|
| F1 | diskU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏à‡∏≤‡∏Å domU |
| F2 | memU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡πÉ‡∏ô memory domU |
| F3 | disk0 | ‡∏ñ‡∏≤‡∏ß‡∏£ | log ‡∏ñ‡∏≤‡∏ß‡∏£‡πÉ‡∏ô provider |
| F4 | mem0 | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÉ‡∏ô dom0 |

> ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ Px ‡πÅ‡∏•‡∏∞ Fy ‡πÉ‡∏ô domU user-level ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å user ‡∏õ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢  
> Fy ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô diskU ‡∏´‡∏£‡∏∑‡∏≠ memU ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢  
> Fy ‡πÉ‡∏ô disk0 (F3) ‡πÄ‡∏õ‡πá‡∏ô log ‡∏ñ‡∏≤‡∏ß‡∏£ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ provider ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏û‡∏•‡∏Å‡∏≤‡∏£

![Figure 3](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure3.png)

üñºÔ∏è *Figure 3: Mapping HP Flogger P2 and P3 on template*  

---

## 6. ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Spam Mail

### üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:
‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á spam mail ‡∏à‡∏≤‡∏Å domU ‚Üí ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô

### üì• ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢:
```bash
mail -s spamSubject winai.wongthai@ncl.ac.uk
```

### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
- ‡πÉ‡∏ä‡πâ `libVMI` (P1) ‡πÉ‡∏ô dom0 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡πà‡∏≤‡∏ô memU
- ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á mail:
  - ag1 = `-s`
  - ag2 = `spamSubject`
  - ag3 = `winai.wongthai@ncl.ac.uk`
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Fy = F3 (disk0)

![Figure 4](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure4.png)

üñºÔ∏è *Figure 4: Logging system ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö spam (CSA Threat #1)*  

![Figure 5](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure5.png)

üñºÔ∏è *Figure 5: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á output ‡∏à‡∏≤‡∏Å Logging App (LA)*  

### Px ‚Äì Logging Process

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å |
|----|------------------|----------|--------------|
| P1 | dom0 user level | libVMI | ‡∏≠‡πà‡∏≤‡∏ô memory ‡∏Ç‡∏≠‡∏á VM |
| P2 | dom0 kernel | Flogger | ‡∏î‡∏±‡∏Å syscall, file, network |
| P3 | domU kernel | Flogger | ‡∏î‡∏±‡∏Å syscall ‡πÉ‡∏ô VM |
| P4 | hypervisor | Logger | ‡∏î‡∏±‡∏Å network ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á domUs |

### Fy ‚Äì Log File

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|----|------------------|--------|---------|
| F1 | diskU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏à‡∏≤‡∏Å domU |
| F2 | memU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡πÉ‡∏ô memory domU |
| F3 | disk0 | ‡∏ñ‡∏≤‡∏ß‡∏£ | log ‡∏ñ‡∏≤‡∏ß‡∏£‡πÉ‡∏ô provider |
| F4 | mem0 | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÉ‡∏ô dom0 |

---

### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á Logging ‡∏Å‡∏£‡∏ì‡∏µ spam

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ô VM (domU) ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢:

```bash
mail -s spamSubject winai.wongthai@ncl.ac.uk
```

‡∏£‡∏∞‡∏ö‡∏ö Logging ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

---

#### üß© Step-by-step ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Logging Template:

1. **‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô domU ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á**
   - ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á mail ‡∏°‡∏µ argument ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
     - `ag1 = -s`
     - `ag2 = spamSubject` (‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•)
     - `ag3 = winai.wongthai@ncl.ac.uk` (‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö)

2. **libVMI (P1 ‡πÉ‡∏ô dom0) ‡∏ó‡∏≥ introspection**
   - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á agent ‡πÉ‡∏ô domU
   - ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• memory ‡∏Ç‡∏≠‡∏á domU (memU) ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å

3. **libVMI ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö process "mail" ‡πÉ‡∏ô memory**
   - ‡∏î‡∏∂‡∏á argument ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏Ñ‡πà‡∏≤ ag1‚Äìag3 ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
   - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•

4. **Logging App (‡πÄ‡∏ä‡πà‡∏ô WallDo/LA) ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ ag2, ag3**
   - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   - ‡∏≠‡∏≤‡∏à‡∏£‡∏ß‡∏° metadata ‡πÄ‡∏ä‡πà‡∏ô user ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ, timestamp

5. **‡πÄ‡∏Å‡πá‡∏ö log ‡∏•‡∏á Fy = F3 (disk0)**
   - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏ó‡∏µ‡πà auditor ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á

---

#### üîê ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á libVMI ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Logging

| ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|-------|--------|
| üì¶ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô domU | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å attacker |
| üîê ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô dom0 | ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏™‡∏π‡∏á ‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å domU |
| üìñ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å memory ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á | ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ log file ‡∏Å‡πá‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏î‡πâ |

---

#### üîÅ ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

```text
User (domU)
 ‚Üì
[mail -s spamSubject email] ‚Üê Suspicious
 ‚Üì
Memory in domU (memU)
 ‚Üì
libVMI (P1 in dom0) ‡∏≠‡πà‡∏≤‡∏ô memU
 ‚Üì
‡∏î‡∏∂‡∏á ag2, ag3 ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
 ‚Üì
Logging App (LA) ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
 ‚Üì
Fy = F3 (disk0) ‚Üê ‡πÄ‡∏Å‡πá‡∏ö log ‡∏ñ‡∏≤‡∏ß‡∏£
```

### üîç ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Logging System ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á spam (‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)

```text
User (domU)
‚Üì
[mail -s spamSubject email] ‚Üê Suspicious
  ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô VM (domU) ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `mail` ‡∏û‡∏£‡πâ‡∏≠‡∏° argument ‡πÄ‡∏ä‡πà‡∏ô
  - ag1 = -s (‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠)
  - ag2 = spamSubject (‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•)
  - ag3 = winai.wongthai@ncl.ac.uk (‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö)
‚Üì
Memory in domU (memU)
  ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏ô ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà RAM ‡∏Ç‡∏≠‡∏á domU (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ memU)
  ‡∏ã‡∏∂‡πà‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á disk ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏π‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏î‡πâ
‚Üì
libVMI (P1 in dom0) ‡∏≠‡πà‡∏≤‡∏ô memU
  Px = P1 ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô dom0 (user-level) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ library ‡∏ä‡∏∑‡πà‡∏≠ `libVMI` ‡πÄ‡∏û‡∏∑‡πà‡∏≠ introspect ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏ö‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô memU
  ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô VM ‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏∑‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏Ç‡∏≠‡∏á VM ‡πÑ‡∏î‡πâ
‚Üì
‡∏î‡∏∂‡∏á ag2, ag3 ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
  libVMI ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏ß‡πà‡∏≤ process `mail` ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
  ‡∏à‡∏∂‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• argument ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å memory ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà:
  - ag2 = spamSubject
  - ag3 = winai.wongthai@ncl.ac.uk
‚Üì
Logging App (LA) ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  ‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô Logging App (‡πÄ‡∏ä‡πà‡∏ô WallDo) ‡∏ö‡∏ô dom0 ‡∏à‡∏∞‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏•‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  ‡∏û‡∏£‡πâ‡∏≠‡∏° timestamp, process ID, ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå
‚Üì
Fy = F3 (disk0) ‚Üê ‡πÄ‡∏Å‡πá‡∏ö log ‡∏ñ‡∏≤‡∏ß‡∏£
  ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• log ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏≤‡∏ß‡∏£‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Fy = F3 ‡∏ã‡∏∂‡πà‡∏á‡∏Ñ‡∏∑‡∏≠ disk0 ‡∏ö‡∏ô‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á provider
  ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ audit ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á ‡πÄ‡∏ä‡πà‡∏ô forensic investigation
```

---

## 7. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

- log (F3) ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏µ‡πà disk0 ‚Üí ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏à‡∏≠‡πà‡∏≤‡∏ô/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç log
- ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô encryption, access control

---

## 8. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå

‚úÖ Template ‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ:
- ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö logging system ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö threat ‡∏Ç‡∏≠‡∏á CSA ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö

> ‚öôÔ∏è ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö cloud accountability ‡πÅ‡∏•‡∏∞ forensic investigation

---

## üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
- [libVMI ‚Äì GitHub](https://github.com/libvmi/libvmi)
- [CSA Top Threats 2013](https://cloudsecurityalliance.org/artifacts/the-notorious-nine-cloud-computing-top-threats-in-2013/)
