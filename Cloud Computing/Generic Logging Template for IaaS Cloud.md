
# üì¶ A Generic Logging Template for IaaS Cloud

> **‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô:** Winai Wongthai, Francisco Liberal Rocha, Aad van Moorsel  
> **‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:** School of Computing Science, Newcastle University  
> **‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå:** 2013  
> **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:** ‡πÄ‡∏™‡∏ô‡∏≠ template ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Logging System ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö IaaS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° Cloud

---

## üìö ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [1. ‡∏ö‡∏ó‡∏ô‡∏≥](#1-‡∏ö‡∏ó‡∏ô‡∏≥)
- [2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS](#2-‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°-iaas)
- [3. ‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° CSA ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ç‡πâ‡∏≠](#3-‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°-csa-‡∏ó‡∏±‡πâ‡∏á-7-‡∏Ç‡πâ‡∏≠)
- [4. Logging System Template](#4-logging-system-template)
- [5. ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Px ‡πÅ‡∏•‡∏∞ Fy](#5-‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö-px-‡πÅ‡∏•‡∏∞-fy)
- [6. ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Spam Mail](#6-‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤-‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö-spam-mail)
- [7. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢](#7-‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
- [8. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå](#8-‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå)

---

## 1. ‡∏ö‡∏ó‡∏ô‡∏≥

Logging system ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô IaaS cloud ‡πÄ‡∏û‡∏∑‡πà‡∏≠:
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
- ‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
- ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°

Logging System = Logging Processes (Px) + Log Files (Fy)

---

## 2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS

‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 2 ‡∏ù‡∏±‡πà‡∏á‡∏´‡∏•‡∏±‡∏Å:

- **Provider Side**: hw ‚Üí hypervisor ‚Üí dom0 ‚Üí domUs  
- **Customer Side**: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πà‡∏≤ domU ‡∏ú‡πà‡∏≤‡∏ô Internet

üñºÔ∏è *Figure 1: The IaaS architecture*  
![Figure 1](94fc84ba-2463-46d6-935e-649fa44071a5.png)

---

## 3. ‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° CSA ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ç‡πâ‡∏≠ (‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°)

| # | ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏° | ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô IaaS |
|--:|----------------|-----------------|------------------|
| 1 | **Abuse and Nefarious Use of Cloud Services** | ‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏±‡∏á‡∏î‡∏µ‡πÉ‡∏ä‡πâ VM ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πà‡∏≤‡∏°‡∏≤‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ | ‡∏™‡∏£‡πâ‡∏≤‡∏á botnet, ‡∏™‡πà‡∏á spam mail, ‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï |
| 2 | **Insecure Interfaces and APIs** | ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏Ç‡∏≠‡∏á API ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏ú‡πà‡∏≤‡∏ô API ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ auth (unauthenticated REST endpoint) |
| 3 | **Malicious Insiders** | ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ cloud ‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏¥‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå | Admin ‡∏Ç‡∏≠‡∏á dom0 ‡∏î‡∏π log ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• |
| 4 | **Shared Technology Issues** | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏¢‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | side-channel attack ‡πÄ‡∏ä‡πà‡∏ô Meltdown, Spectre |
| 5 | **Data Loss or Leakage** | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏Ç‡πÇ‡∏°‡∏¢‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö cloud | VM crash ‡πÅ‡∏•‡πâ‡∏ß data ‡∏ö‡∏ô disk ‡∏´‡∏≤‡∏¢, ‡∏Å‡∏≤‡∏£ config S3 ‡∏ú‡∏¥‡∏î |
| 6 | **Account or Service Hijacking** | ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡πÅ‡∏Æ‡πá‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πÇ‡∏°‡∏¢ token access | ‡∏Ç‡πÇ‡∏°‡∏¢ SSH key ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á VM ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß |
| 7 | **Unknown Risk Profile** | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ provider ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô | ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ log ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? ‡πÉ‡∏Ñ‡∏£‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡∏π? ‡∏´‡∏£‡∏∑‡∏≠ VM ‡πÅ‡∏ä‡∏£‡πå‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£?

---

## 4. Logging System Template

Template ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ß‡∏≤‡∏á Logging Process (Px) ‡πÅ‡∏•‡∏∞ Log File (Fy)  
‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô domU, dom0, hypervisor

üñºÔ∏è *Figure 2: Logging System Template*  
![Figure 2](1fcdfacd-03ed-41a6-9cd0-acc93e4a4fe2.png)

---

---

## 5. ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Px ‡πÅ‡∏•‡∏∞ Fy

### Px ‚Äì Logging Process

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å |
|----|------------------|----------|--------------|
| P1 | dom0 user level | libVMI | ‡∏≠‡πà‡∏≤‡∏ô memory ‡∏Ç‡∏≠‡∏á VM |
| P2 | dom0 kernel | Flogger | ‡∏î‡∏±‡∏Å syscall, file, network |
| P3 | domU kernel | Flogger | ‡∏î‡∏±‡∏Å syscall ‡πÉ‡∏ô VM |
| P4 | hypervisor | Logger | ‡∏î‡∏±‡∏Å network ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á domUs |

### Fy ‚Äì Log File

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|----|------------------|--------|---------|
| F1 | diskU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏à‡∏≤‡∏Å domU |
| F2 | memU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡πÉ‡∏ô memory domU |
| F3 | disk0 | ‡∏ñ‡∏≤‡∏ß‡∏£ | log ‡∏ñ‡∏≤‡∏ß‡∏£‡πÉ‡∏ô provider |
| F4 | mem0 | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÉ‡∏ô dom0 |

> ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ Px ‡πÅ‡∏•‡∏∞ Fy ‡πÉ‡∏ô domU user-level ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å user ‡∏õ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢  
> Fy ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô diskU ‡∏´‡∏£‡∏∑‡∏≠ memU ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢  
> Fy ‡πÉ‡∏ô disk0 (F3) ‡πÄ‡∏õ‡πá‡∏ô log ‡∏ñ‡∏≤‡∏ß‡∏£ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ provider ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏û‡∏•‡∏Å‡∏≤‡∏£

üñºÔ∏è *Figure 3: Mapping HP Flogger P2 and P3 on template*  
![Figure 3](8e777ab6-225a-464b-8aea-1dff702245a9.png)

---

## 6. ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Spam Mail

### üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:
‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á spam mail ‡∏à‡∏≤‡∏Å domU ‚Üí ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô

### üì• ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢:
```bash
mail -s spamSubject winai.wongthai@ncl.ac.uk
```

### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
- ‡πÉ‡∏ä‡πâ `libVMI` (P1) ‡πÉ‡∏ô dom0 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡πà‡∏≤‡∏ô memU
- ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á mail:
  - ag1 = `-s`
  - ag2 = `spamSubject`
  - ag3 = `winai.wongthai@ncl.ac.uk`
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Fy = F3 (disk0)

üñºÔ∏è *Figure 4: Logging system ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö spam (CSA Threat #1)*  
![Figure 4](1cdc66ee-34ee-4958-83a5-ced47a94d645.png)

üñºÔ∏è *Figure 5: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á output ‡∏à‡∏≤‡∏Å Logging App (LA)*  
![Figure 5](c6677e1a-644f-4553-bc6d-8a417ac00397.png)

### Px ‚Äì Logging Process

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å |
|----|------------------|----------|--------------|
| P1 | dom0 user level | libVMI | ‡∏≠‡πà‡∏≤‡∏ô memory ‡∏Ç‡∏≠‡∏á VM |
| P2 | dom0 kernel | Flogger | ‡∏î‡∏±‡∏Å syscall, file, network |
| P3 | domU kernel | Flogger | ‡∏î‡∏±‡∏Å syscall ‡πÉ‡∏ô VM |
| P4 | hypervisor | Logger | ‡∏î‡∏±‡∏Å network ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á domUs |

### Fy ‚Äì Log File

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|----|------------------|--------|---------|
| F1 | diskU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏à‡∏≤‡∏Å domU |
| F2 | memU | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡πÉ‡∏ô memory domU |
| F3 | disk0 | ‡∏ñ‡∏≤‡∏ß‡∏£ | log ‡∏ñ‡∏≤‡∏ß‡∏£‡πÉ‡∏ô provider |
| F4 | mem0 | ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÉ‡∏ô dom0 |

---

### üß† ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á Logging ‡∏Å‡∏£‡∏ì‡∏µ spam

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏ô VM (domU) ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢:

```bash
mail -s spamSubject winai.wongthai@ncl.ac.uk
```

‡∏£‡∏∞‡∏ö‡∏ö Logging ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

---

#### üß© Step-by-step ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Logging Template:

1. **‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô domU ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á**
   - ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á mail ‡∏°‡∏µ argument ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
     - `ag1 = -s`
     - `ag2 = spamSubject` (‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•)
     - `ag3 = winai.wongthai@ncl.ac.uk` (‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö)

2. **libVMI (P1 ‡πÉ‡∏ô dom0) ‡∏ó‡∏≥ introspection**
   - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á agent ‡πÉ‡∏ô domU
   - ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• memory ‡∏Ç‡∏≠‡∏á domU (memU) ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å

3. **libVMI ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö process "mail" ‡πÉ‡∏ô memory**
   - ‡∏î‡∏∂‡∏á argument ‡∏ó‡∏±‡πâ‡∏á 3 ‡∏Ñ‡πà‡∏≤ ag1‚Äìag3 ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
   - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•

4. **Logging App (‡πÄ‡∏ä‡πà‡∏ô WallDo/LA) ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ ag2, ag3**
   - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   - ‡∏≠‡∏≤‡∏à‡∏£‡∏ß‡∏° metadata ‡πÄ‡∏ä‡πà‡∏ô user ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ, timestamp

5. **‡πÄ‡∏Å‡πá‡∏ö log ‡∏•‡∏á Fy = F3 (disk0)**
   - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏ó‡∏µ‡πà auditor ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á

---

#### üîê ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á libVMI ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Logging

| ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|-------|--------|
| üì¶ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô domU | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å attacker |
| üîê ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô dom0 | ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏™‡∏π‡∏á ‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å domU |
| üìñ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å memory ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á | ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ log file ‡∏Å‡πá‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏î‡πâ |

---

#### üîÅ ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

```text
User (domU)
 ‚Üì
[mail -s spamSubject email] ‚Üê Suspicious
 ‚Üì
Memory in domU (memU)
 ‚Üì
libVMI (P1 in dom0) ‡∏≠‡πà‡∏≤‡∏ô memU
 ‚Üì
‡∏î‡∏∂‡∏á ag2, ag3 ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
 ‚Üì
Logging App (LA) ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
 ‚Üì
Fy = F3 (disk0) ‚Üê ‡πÄ‡∏Å‡πá‡∏ö log ‡∏ñ‡∏≤‡∏ß‡∏£
```

---

## 7. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

- log (F3) ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏µ‡πà disk0 ‚Üí ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏à‡∏≠‡πà‡∏≤‡∏ô/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç log
- ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô encryption, access control

---

## 8. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå

‚úÖ Template ‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ:
- ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö logging system ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö threat ‡∏Ç‡∏≠‡∏á CSA ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö

> ‚öôÔ∏è ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö cloud accountability ‡πÅ‡∏•‡∏∞ forensic investigation
