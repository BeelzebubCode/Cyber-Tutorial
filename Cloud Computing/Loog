# üß± A Generic Logging Template for IaaS Cloud

> ‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢: *"A Generic Logging Template for Infrastructure as a Service Cloud"*  
> ‡πÇ‡∏î‡∏¢ Winai Wongthai, Francisco Liberal Rocha, Aad van Moorsel (Newcastle University)

---

## üìë ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [üìå ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Logging Template](#-‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°-logging-template)
- [üñºÔ∏è ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS (Figure 1)](#-‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°-iaas-figure-1)
- [üß© ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á Template (Figure 2)](#-‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á-template-figure-2)
  - [üì¶ ‡∏ä‡∏∏‡∏î IaaS Components](#-‡∏ä‡∏∏‡∏î-iaas-components)
  - [‚öôÔ∏è Logging Processes (Px)](#Ô∏è-logging-processes-px)
  - [üóÉÔ∏è Log Files (Fy)](#Ô∏è-log-files-fy)
- [üóÇÔ∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Critical Files ‡πÅ‡∏•‡∏∞ Threat 1](#-‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á-critical-files-‡πÅ‡∏•‡∏∞-threat-1)
  - [üìÅ Customers‚Äô Critical Files in domUs](#-customers-critical-files-in-domus)
  - [üö® Threat 1: Abuse of Cloud to Attack](#-threat-1-abuse-of-cloud-to-attack)
- [üîí Security Consideration](#-security-consideration)
- [üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á](#-‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)

---

## üìå ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Logging Template

Template ‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Logging ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö IaaS ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏î‡∏¢ CSA (Cloud Security Alliance)

‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏´‡∏•‡∏±‡∏Å:
- ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å 7 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á CSA
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Logging ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î Accountability ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á (Auditability)

---

## üñºÔ∏è ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° IaaS (Figure 1)

> IaaS ‡πÅ‡∏ö‡∏ö Xen-based ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ dom0, domU, hypervisor ‡πÅ‡∏•‡∏∞ hardware

![Figure 1 - IaaS Architecture](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure1.png)

- `dom0` ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏π‡∏á ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏•‡∏ö domU
- `domU` ‡πÄ‡∏õ‡πá‡∏ô VM ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- `hypervisor` ‡πÄ‡∏õ‡πá‡∏ô‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ VM
- `hw` ‡∏Ñ‡∏∑‡∏≠ physical server ‡∏à‡∏£‡∏¥‡∏á

---

## üß© ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á Template (Figure 2)

‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á Logging Process (Px) ‡πÅ‡∏•‡∏∞ Log File (Fy) ‡∏ö‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á IaaS  
‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Logging ‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á

![Figure 2 - Logging Template](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure2.png)

---

### üì¶ ‡∏ä‡∏∏‡∏î IaaS Components

| Component | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô IaaS |
|----------|------------|----------------|
| `hw0`    | ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö | Provider |
| `disk0`  | Physical Disk ‡∏Ç‡∏≠‡∏á hw0 | hw0 |
| `mem0`   | Main Memory ‡∏Ç‡∏≠‡∏á hw0 | hw0 |
| `hypervisor` | ‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ VM | ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á hw0 ‚Üî dom0 |
| `dom0`   | ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Root | Provider |
| `app0`   | Logging App ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô‡πÉ‡∏ô dom0 | dom0 |
| `domU`   | Guest OS ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô | User |
| `appU`   | ‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô domU | User |
| `hwU`    | ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á domU | Virtual Layer |
| `diskU`  | Virtual Disk ‡πÉ‡∏ô domU | ‡∏ö‡∏ô disk0 ‡∏à‡∏£‡∏¥‡∏á |
| `memU`   | Virtual Memory ‡πÉ‡∏ô domU | ‡∏ö‡∏ô mem0 ‡∏à‡∏£‡∏¥‡∏á |

---

### ‚öôÔ∏è Logging Processes (Px)

| Px | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà |
|----|----------|----------|
| `P1` | dom0 user | ‡∏≠‡πà‡∏≤‡∏ô memU ‡∏ú‡πà‡∏≤‡∏ô libVMI |
| `P2` | dom0 kernel | ‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö network/file ops |
| `P3` | domU kernel | ‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö system call ‡∏Ç‡∏≠‡∏á domU |
| `P4` | hypervisor | ‡∏î‡∏±‡∏Å network packet ‡∏Ç‡∏≠‡∏á domU |

---

### üóÉÔ∏è Log Files (Fy)

| Fy | ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á | ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• |
|----|----------|--------------|
| `F1` | diskU | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß |
| `F2` | memU | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß |
| `F3` | disk0 | log ‡∏ñ‡∏≤‡∏ß‡∏£ |
| `F4` | mem0 | log ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß |

---

## üóÇÔ∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á Critical Files ‡πÅ‡∏•‡∏∞ Threat 1

### üìÅ Customers‚Äô Critical Files in domUs

- ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÑ‡∏ß‡πâ‡πÉ‡∏ô `diskU` ‡πÄ‡∏ä‡πà‡∏ô:
  - source code, database, binary, ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
- ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏±‡∏¢‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á

üñºÔ∏è **Figure 3: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á critical file (f) ‡πÉ‡∏ô diskU**

![Figure 3 - Critical File in diskU](https://github.com/BeelzebubCode/Cyber-Tutorial/blob/main/Cloud%20Computing/Image/Img-Logging/figure3.png)

‡πÉ‡∏ô‡∏†‡∏≤‡∏û:  
- Alice ‡πÉ‡∏ä‡πâ `appU` ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå f  
- `dom0` ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏≠‡∏ö‡∏î‡∏π‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô `P1` (‡πÄ‡∏ä‡πà‡∏ô libVMI)

---

### üö® Threat 1: Abuse of Cloud to Attack

#### A. ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

| ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|----------|-------------|
| domU ‚Üí domU | VM ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡πÅ‡∏≠‡∏ö‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏à‡∏°‡∏ï‡∏µ VM ‡∏≠‡∏∑‡πà‡∏ô |
| domU ‚Üí dom0 | ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà hypervisor ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≤‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤ dom0 |
| dom0 ‚Üí domU | ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠ attacker ‡πÅ‡∏≠‡∏ö‡∏≠‡πà‡∏≤‡∏ô memory / log ‡πÉ‡∏ô domU |

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:  
- ‡∏î‡∏∂‡∏á private key ‡∏à‡∏≤‡∏Å EC2 VM ‡∏≠‡∏∑‡πà‡∏ô  
- ‡∏≠‡πà‡∏≤‡∏ô database ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á spam ‡∏ú‡πà‡∏≤‡∏ô memU

#### B. ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£

| ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|----------|-------------|
| domU ‚Üí dom0 | ‡∏´‡∏≤‡∏Å domU ‡πÄ‡∏à‡∏≤‡∏∞ hypervisor ‡πÑ‡∏î‡πâ ‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° dom0 |
| ‡∏Ç‡πâ‡∏≤‡∏° host | ‡∏Ç‡πâ‡∏≤‡∏° physical boundary ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á host ‡πÑ‡∏î‡πâ |

---

## üîí Security Consideration

- ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á Px ‡πÅ‡∏•‡∏∞ Fy ‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÄ‡∏ä‡πà‡∏ô:
  - `F3` ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `disk0` ‡∏ã‡∏∂‡πà‡∏á provider ‡∏≠‡∏≤‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ
  - `F1`, `F2` ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô domU ‚Üí ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ñ‡∏π‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏•‡∏ö
- ‡∏Å‡∏≤‡∏£‡∏•‡∏î TCB (Trusted Computing Base) ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÄ‡∏ä‡πà‡∏ô:
  - ‡πÉ‡∏ä‡πâ `P1` (libVMI) ‡πÉ‡∏ô dom0 ‡πÅ‡∏ó‡∏ô‡∏ß‡∏≤‡∏á logger ‡πÉ‡∏ô domU
- ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ Third-party auditing, encryption, TPM, ‡∏´‡∏£‡∏∑‡∏≠ log forwarding

---

## üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- CSA: [Top Threats to Cloud Computing](https://cloudsecurityalliance.org/research/top-threats){:target="_blank"}
- Wongthai et al. (2013), "A Generic Logging Template for IaaS"
- IEEE Xplore: [https://ieeexplore.ieee.org/document/6558685](https://ieeexplore.ieee.org/document/6558685){:target="_blank"}

